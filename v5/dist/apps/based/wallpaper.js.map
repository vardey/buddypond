{"version":3,"file":"wallpaper.js","sources":["../../../apps/based/wallpaper/WallpaperManager.js","../../../apps/based/wallpaper/setWallpaper.js","../../../apps/based/wallpaper/removeWallpaper.js","../../../apps/based/wallpaper/wallpaper.js"],"sourcesContent":["import setWallpaper from './setWallpaper.js';\nimport removeWallpaper from './removeWallpaper.js';\n\nexport default class WallpaperManager {\n    constructor(bp) {\n        this.bp = bp;\n        this.canvas = null;\n        this.label = 'Wallpaper';\n        this.settings = {};\n        this.init = false;\n        this.width = 0;\n        this.height = 0;\n        this.wallpapers = {};\n        this.paused = false;\n        this.active = null;\n        this._wallpapers = {\n            'solid': {\n                label: 'Solid',\n                src: ['/v5/apps/based/wallpaper/wallpapers/solid.js']\n            },\n            'matrix': {\n                label: 'Matrix',\n                src: ['/v5/apps/based/wallpaper/wallpapers/matrix.js']\n            },\n            'nyancat': {\n                label: 'Nyan Cat',\n                src: ['/v5/apps/based/wallpaper/wallpapers/nyancat.js']\n            },\n            'ripples': {\n                label: 'Ripples',\n                src: [\n                    '/v5/apps/based/wallpaper/wallpapers/ripples/ripples.js'\n                ]\n            },\n            'url': {\n                label: 'URL',\n                src: ['/v5/apps/based/wallpaper/wallpapers/url.js']\n            },\n            'default': {\n                label: 'Default',\n                src: ['/v5/apps/based/wallpaper/wallpapers/default/default.js']\n            }\n        };\n\n        // check if a canvas with id 'c' exists, if not create one\n        if (!document.getElementById('c')) {\n            this.canvas = document.createElement('canvas');\n            this.canvas.id = 'c';\n            this.canvas.style.position = 'fixed';\n            this.canvas.style.top = '0';\n            this.canvas.style.left = '0';\n            this.canvas.style.zIndex = '-1';\n            this.canvas.style.width = '100%';\n            this.canvas.style.height = '100%';\n            this.canvas.style.pointerEvents = 'none';\n            document.body.appendChild(this.canvas);\n        } else {\n            this.canvas = document.getElementById('c');\n        }\n\n\n        bp.on('settings::wallpaper_color', 'update-wallpaper-bg-color', (color) => {\n            if (this.wallpapers[this.active]) {\n                this.wallpapers[this.active].changeColor(color);\n            }\n        });\n\n    }\n\n    async load(params, next) {\n        try {\n            this.resizeCanvasToWindow();\n            // console.log('Loading wallpapers', this.bp.settings);\n            // check to see if this.settings.wallpaper_url is set\n            if (this.bp.settings.wallpaper_url) {\n                this.setWallpaper(this.bp.settings.wallpaper_url);\n            } else {\n                this.active = this.bp.settings.wallpaper_name || 'default';\n                this.start();\n            }\n            this.setupEventListeners();\n            next();\n        } catch (error) {\n            console.error('Error loading assets:', error);\n        }\n    }\n\n    resizeCanvasToWindow() {\n        let canvas = document.getElementById('c');\n        canvas.height = window.innerHeight;\n        canvas.width = window.innerWidth;\n        this.height = window.innerHeight;\n        this.width = window.innerWidth;\n    }\n\n    async start() {\n        this.paused = false;\n        this.resizeCanvasToWindow();\n\n        if (!this.wallpapers[this.active]) {\n            let remoteScript = this._wallpapers[this.active].src;\n            // console.log('Loading wallpaper:', this.active, remoteScript);\n            let wp = await this.bp.importModule(remoteScript[0], {}, false);\n            this.wallpapers[this.active] = new wp.default('c');\n            // check for load function, call if required\n            // Remark: This is a bit of a \"sub-app\" pattern,\n            // it might be better to have each wallpaper be it's own app\n            this.wallpapers[this.active].start(this.bp);\n\n        } else {\n            this.wallpapers[this.active].start(this.bp);\n        }\n    }\n\n    pause() {\n        this.paused = true;\n        this.wallpapers[this.active].pause();\n    }\n\n    stop() {\n        if (this.wallpapers[this.active] && this.wallpapers[this.active].stop) {\n            this.wallpapers[this.active].stop();\n        }\n        this.clear();\n    }\n\n    clear() {\n        let canvas = document.getElementById('c');\n        let ctx = canvas.getContext('2d');\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n    }\n\n    loadRemoteAssets(assets, callback) {\n        // Simulate asset loading\n        console.log(`Loading assets: ${assets.join(', ')}`);\n        setTimeout(callback, 1000); // Simulating async loading\n    }\n\n    setupEventListeners() {\n        window.addEventListener('resize', (e) => {\n            if (e.target !== window) return;\n            this.resizeCanvasToWindow();\n            if (this.wallpapers[this.active] && this.wallpapers[this.active].resize) {\n                this.wallpapers[this.active].resize();\n            }\n        });\n\n        $('.pauseWallpaper').on('click', () => {\n            if (this.paused) {\n                this.start();\n                $('.pauseWallpaper').html('Pause Wallpaper');\n            } else {\n                $('#wallpaper').fadeOut('slow');\n                $('.pauseWallpaper').html('Resume Wallpaper');\n                this.pause();\n            }\n        });\n    }\n}\n\nWallpaperManager.prototype.setWallpaper = setWallpaper;\nWallpaperManager.prototype.removeWallpaper = removeWallpaper;","export default function setWallpaper (url) {\n\n    if (!url) {\n        url = prompt('Enter the URL for the wallpaper');\n    }\n\n    if (!url) {\n        console.error('No URL provided for wallpaper');\n        return;\n    }\n\n    // set the #wallpaper element to the url\n    let wallpaper = document.getElementById('wallpaper');\n    wallpaper.src = url;\n\n    // show the element\n    wallpaper.style.display = 'block';\n\n    // save the wallpaper setting in local storage\n    this.bp.set('wallpaper_url', url);\n\n    this.wallpaperManager.stop();\n\n}","export default function removeWallpaper () {\n\n\n    // set the #wallpaper element to the url\n    let wallpaper = document.getElementById('wallpaper');\n    wallpaper.src = '';\n    // hide the wallpaper\n    wallpaper.style.display = 'none';\n\n    // save the wallpaper setting in local storage\n    this.bp.set('wallpaper_url', null);\n\n    this.bp.apps.wallpaper.wallpaperManager.stop();\n\n}","import WallpaperManager from './WallpaperManager.js';\n\nexport default class Wallpaper {\n    constructor(bp, options = {}) {\n        this.bp = bp;\n        return this;\n    }\n\n    async init() {\n        const wallpaperManager = new WallpaperManager(this.bp);\n        wallpaperManager.load({}, () => {\n            //console.log('Wallpapers loaded')\n        });\n        this.wallpaperManager = wallpaperManager;\n        this.bp.on('settings::wallpaper_name', 'update-wallpaper', function (data) {\n            wallpaperManager.stop();\n            console.log(`Wallpaper changed to ${data}`);\n            wallpaperManager.active = data;\n            wallpaperManager.start();\n        });\n        return 'loaded Wallpaper';\n    }\n\n    setWallpaper(url) {\n        this.wallpaperManager.setWallpaper(url);\n    }\n\n    removeWallpaper() {\n        this.wallpaperManager.removeWallpaper();\n    }\n\n    setDefaultWallpaper() {\n        // alert('Setting default wallpaper');\n    }\n}"],"names":["WallpaperManager","constructor","bp","this","canvas","label","settings","init","width","height","wallpapers","paused","active","_wallpapers","solid","src","matrix","nyancat","ripples","url","default","document","getElementById","createElement","id","style","position","top","left","zIndex","pointerEvents","body","appendChild","on","color","changeColor","load","params","next","resizeCanvasToWindow","wallpaper_url","setWallpaper","wallpaper_name","start","setupEventListeners","error","console","window","innerHeight","innerWidth","remoteScript","wp","importModule","pause","stop","clear","getContext","clearRect","loadRemoteAssets","assets","callback","log","join","setTimeout","addEventListener","e","target","resize","$","html","fadeOut","prototype","prompt","wallpaper","display","set","wallpaperManager","removeWallpaper","apps","Wallpaper","options","data","setDefaultWallpaper"],"mappings":"AAGe,MAAMA,EACjB,WAAAC,CAAYC,GACRC,KAAKD,GAAKA,EACVC,KAAKC,OAAS,KACdD,KAAKE,MAAQ,YACbF,KAAKG,SAAW,CAAE,EAClBH,KAAKI,MAAO,EACZJ,KAAKK,MAAQ,EACbL,KAAKM,OAAS,EACdN,KAAKO,WAAa,CAAE,EACpBP,KAAKQ,QAAS,EACdR,KAAKS,OAAS,KACdT,KAAKU,YAAc,CACfC,MAAS,CACLT,MAAO,QACPU,IAAK,CAAC,iDAEVC,OAAU,CACNX,MAAO,SACPU,IAAK,CAAC,kDAEVE,QAAW,CACPZ,MAAO,WACPU,IAAK,CAAC,mDAEVG,QAAW,CACPb,MAAO,UACPU,IAAK,CACD,2DAGRI,IAAO,CACHd,MAAO,MACPU,IAAK,CAAC,+CAEVK,QAAW,CACPf,MAAO,UACPU,IAAK,CAAC,4DAKTM,SAASC,eAAe,KAYzBnB,KAAKC,OAASiB,SAASC,eAAe,MAXtCnB,KAAKC,OAASiB,SAASE,cAAc,UACrCpB,KAAKC,OAAOoB,GAAK,IACjBrB,KAAKC,OAAOqB,MAAMC,SAAW,QAC7BvB,KAAKC,OAAOqB,MAAME,IAAM,IACxBxB,KAAKC,OAAOqB,MAAMG,KAAO,IACzBzB,KAAKC,OAAOqB,MAAMI,OAAS,KAC3B1B,KAAKC,OAAOqB,MAAMjB,MAAQ,OAC1BL,KAAKC,OAAOqB,MAAMhB,OAAS,OAC3BN,KAAKC,OAAOqB,MAAMK,cAAgB,OAClCT,SAASU,KAAKC,YAAY7B,KAAKC,SAMnCF,EAAG+B,GAAG,4BAA6B,6BAA8BC,IACzD/B,KAAKO,WAAWP,KAAKS,SACrBT,KAAKO,WAAWP,KAAKS,QAAQuB,YAAYD,KAIzD,CAEI,UAAME,CAAKC,EAAQC,GACf,IACInC,KAAKoC,uBAGDpC,KAAKD,GAAGI,SAASkC,cACjBrC,KAAKsC,aAAatC,KAAKD,GAAGI,SAASkC,gBAEnCrC,KAAKS,OAAST,KAAKD,GAAGI,SAASoC,gBAAkB,UACjDvC,KAAKwC,SAETxC,KAAKyC,sBACLN,GACH,CAAC,MAAOO,GACLC,QAAQD,MAAM,wBAAyBA,EACnD,CACA,CAEI,oBAAAN,GACI,IAAInC,EAASiB,SAASC,eAAe,KACrClB,EAAOK,OAASsC,OAAOC,YACvB5C,EAAOI,MAAQuC,OAAOE,WACtB9C,KAAKM,OAASsC,OAAOC,YACrB7C,KAAKK,MAAQuC,OAAOE,UAC5B,CAEI,WAAMN,GAIF,GAHAxC,KAAKQ,QAAS,EACdR,KAAKoC,uBAEApC,KAAKO,WAAWP,KAAKS,QAWtBT,KAAKO,WAAWP,KAAKS,QAAQ+B,MAAMxC,KAAKD,QAXT,CAC/B,IAAIgD,EAAe/C,KAAKU,YAAYV,KAAKS,QAAQG,IAE7CoC,QAAWhD,KAAKD,GAAGkD,aAAaF,EAAa,GAAI,CAAE,GAAE,GACzD/C,KAAKO,WAAWP,KAAKS,QAAU,IAAIuC,EAAG/B,QAAQ,KAI9CjB,KAAKO,WAAWP,KAAKS,QAAQ+B,MAAMxC,KAAKD,GAEpD,CAGA,CAEI,KAAAmD,GACIlD,KAAKQ,QAAS,EACdR,KAAKO,WAAWP,KAAKS,QAAQyC,OACrC,CAEI,IAAAC,GACQnD,KAAKO,WAAWP,KAAKS,SAAWT,KAAKO,WAAWP,KAAKS,QAAQ0C,MAC7DnD,KAAKO,WAAWP,KAAKS,QAAQ0C,OAEjCnD,KAAKoD,OACb,CAEI,KAAAA,GACI,IAAInD,EAASiB,SAASC,eAAe,KAC3BlB,EAAOoD,WAAW,MACxBC,UAAU,EAAG,EAAGrD,EAAOI,MAAOJ,EAAOK,OACjD,CAEI,gBAAAiD,CAAiBC,EAAQC,GAErBd,QAAQe,IAAI,mBAAmBF,EAAOG,KAAK,SAC3CC,WAAWH,EAAU,IAC7B,CAEI,mBAAAhB,GACIG,OAAOiB,iBAAiB,UAAWC,IAC3BA,EAAEC,SAAWnB,SACjB5C,KAAKoC,uBACDpC,KAAKO,WAAWP,KAAKS,SAAWT,KAAKO,WAAWP,KAAKS,QAAQuD,QAC7DhE,KAAKO,WAAWP,KAAKS,QAAQuD,aAIrCC,EAAE,mBAAmBnC,GAAG,SAAS,KACzB9B,KAAKQ,QACLR,KAAKwC,QACLyB,EAAE,mBAAmBC,KAAK,qBAE1BD,EAAE,cAAcE,QAAQ,QACxBF,EAAE,mBAAmBC,KAAK,oBAC1BlE,KAAKkD,WAGrB,EAGArD,EAAiBuE,UAAU9B,aChKZ,SAAuBtB,GAMlC,GAJKA,IACDA,EAAMqD,OAAO,qCAGZrD,EAED,YADA2B,QAAQD,MAAM,iCAKlB,IAAI4B,EAAYpD,SAASC,eAAe,aACxCmD,EAAU1D,IAAMI,EAGhBsD,EAAUhD,MAAMiD,QAAU,QAG1BvE,KAAKD,GAAGyE,IAAI,gBAAiBxD,GAE7BhB,KAAKyE,iBAAiBtB,MAE1B,ED0IAtD,EAAiBuE,UAAUM,gBEjKZ,WAIX,IAAIJ,EAAYpD,SAASC,eAAe,aACxCmD,EAAU1D,IAAM,GAEhB0D,EAAUhD,MAAMiD,QAAU,OAG1BvE,KAAKD,GAAGyE,IAAI,gBAAiB,MAE7BxE,KAAKD,GAAG4E,KAAKL,UAAUG,iBAAiBtB,MAE5C,ECZe,MAAMyB,EACjB,WAAA9E,CAAYC,EAAI8E,EAAU,IAEtB,OADA7E,KAAKD,GAAKA,EACHC,IACf,CAEI,UAAMI,GACF,MAAMqE,EAAmB,IAAI5E,EAAiBG,KAAKD,IAWnD,OAVA0E,EAAiBxC,KAAK,CAAA,GAAI,SAG1BjC,KAAKyE,iBAAmBA,EACxBzE,KAAKD,GAAG+B,GAAG,2BAA4B,oBAAoB,SAAUgD,GACjEL,EAAiBtB,OACjBR,QAAQe,IAAI,wBAAwBoB,KACpCL,EAAiBhE,OAASqE,EAC1BL,EAAiBjC,OAC7B,IACe,kBACf,CAEI,YAAAF,CAAatB,GACThB,KAAKyE,iBAAiBnC,aAAatB,EAC3C,CAEI,eAAA0D,GACI1E,KAAKyE,iBAAiBC,iBAC9B,CAEI,mBAAAK,GAEJ"}