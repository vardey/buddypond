{"version":3,"file":"menubar.js","sources":["../../../apps/based/menubar/lib/defaultMenuBar.js","../../../apps/based/menubar/menubar.js"],"sourcesContent":["export default function defaultMenuBar(bp) {\n\n  // Ported from Legacy bp v4\n  let selectMusicPlaylist2 = `\n    <select name=\"selectPlaylist\" class=\"selectPlaylist float_right\">\n    <option>Select music playlist...</option>\n    <option value=\"1397230333\">Buddy House 0 ( 33 Tracks )</option>\n    <option value=\"1397493787\">Buddy House 1 ( 10 Tracks )</option>\n    <option value=\"1427128612\">Buddy House 2 ( 10 Tracks )</option>\n    </select>\n    `;\n\n\n  let selectMusicPlaylist = `\n<div class=\"dropdown-wrapper float_right select-playlist-dropdown-menu\">\n  <span class=\"icon trigger\" title=\"Select Music Playlist\">\n    <i class=\"fa-duotone fa-regular fa-music\"></i> Select Music Playlist\n  </span>\n  <ul class=\"dropdown-menu\" style=\"display: none;\">\n    <li data-value=\"1397230333\">Buddy House 0 (33 Tracks)</li>\n    <li data-value=\"1397493787\">Buddy House 1 (10 Tracks)</li>\n    <li data-value=\"1427128612\">Buddy House 2 (10 Tracks)</li>\n  </ul>\n</div>\n    `;\n\n  // change to select background / wallpaper / customize theme\n  let selectTheme = `\n    <select name=\"selectTheme\" class=\"selectTheme float_right\">\n    <option value=\"Light\">Light Theme</option>\n    <option value=\"Dark\">Dark Theme</option>\n    <option value=\"Nyan\">Nyan Theme</option>\n    <option value=\"Hacker\">Hacker Theme</option>\n    <option value=\"Water\">Water Theme</option>\n    <option value=\"Customize\">Customize...</option>\n    <!--\n    <option value=\"Customize\">EPIC MODE ( my poor browser ) </option>\n    <option value=\"Customize\">Comic Theme</option> \n    -->\n    </select>\n    `;\n\n\n\n  //        <span class=\"personalizeDesktop float_right\"><i class=\"fa-duotone fa-regular fa-desktop\" title=\"Desktop Settings\"></i>Desktop Settings</span>\n\n  let selectDesktopSettings = `\n<div class=\"dropdown-wrapper desktop-settings-dropdown-menu\">\n  <span class=\"icon trigger\" title=\"Desktop Settings\">\n    <i class=\"fa-duotone fa-regular fa-desktop\"></i> Desktop Settings\n  </span>\n  <ul class=\"dropdown-menu\" style=\"display: none;\">\n    <li data-value=\"open\">Open Desktop Settings</li>\n    <li data-value=\"matrix\">Matrix Wallpaper</li>\n    <li data-value=\"nyancat\">Nyan Cat Wallpaper</li>\n    <li data-value=\"ripples\">Ripples Wallpaper</li>\n    <li data-value=\"urlWallpaper\">Set Wallpaper to Url</li>\n    <li data-value=\"default\">Default Wallpaper</li>\n  </ul>\n</div>\n    `;\n\n\n  let sourceCodeStr = `\n <div class=\"dropdown-wrapper desktop-settings-dropdown-menu\">\n   <span class=\"icon trigger\" title=\"Developers\">\n    <i class=\"fa-duotone fa-regular fa-code\"></i> Developers\n   </span>\n   <ul class=\"dropdown-menu\" style=\"display: none;\">\n     <li class=\"open-link\" data-link=\"https://github.com/buddypond/buddypond\">View Source Code</li>\n     <li class=\"open-link\" data-link=\"https://buddypond.com/sdk\">Developer SDK</li>\n   </ul>\n </div>\n   `;\n\n\n  // use fonr-awesome sun and moon icons\n  let selectLightMode = '<span class=\"selectLightMode float_right\"><i class=\"fa-duotone fa-regular fa-sun\" data-mode=\"Light\" title=\"Light Mode\"></i><i class=\"fa-duotone fa-regular fa-moon\" data-mode=\"Dark\" title=\"Dark Mode\"></i></span>';\n\n  let networkStatsStr = `\n      <span class=\"totalConnected loggedIn\">\n        <!-- <span class=\"totalConnectedCount\">0</span> Buddies Online</span> -->\n        <span class=\"desktopDisconnected loggedOut\">Disconnected</span>\n            \n    `;\n\n  let volumeStr = `\n    <div class=\"volume\">\n    <span class=\"volumeIcon volumeToggle volumeFull\">ðŸ”Š</span>\n    <span class=\"volumeIcon volumeToggle volumeMuted\">ðŸ”‡</span>\n    <div class=\"volumeSliderContainer\">\n      <div id=\"toggleVolumeSlider\" class=\"volumeSlider\"></div>\n      <div class=\"volume-enabled-checkbox\">\n        <input type=\"checkbox\" id=\"enableVolume\" name=\"enableVolume\">\n        <label for=\"enableVolume\" title=\"Enable sound effects\">Mute</label>\n      </div>\n\n    </div>\n    \n    </div>\n    `;\n\n  let clockStr = `\n    <span id=\"clock\"></span>\n    `;\n\n  let menuTemplate = [\n    {\n      label: '<span id=\"me_title\" class=\"me_title\">Welcome - You look nice today!</span>',\n      submenu: [\n        {\n          label: '<span>We are stoked to be your Buddy</span>',\n          className: 'desktop-only'\n          // click: () => api.ui.toggleDeviceSettings() \n        },\n        {\n          label: 'Buddy Apps',\n          closeMenu: true,\n          click: () => bp.open('pad')\n        },\n\n        {\n          label: 'Edit Profile',\n          closeMenu: true,\n          click: () => bp.open('profile')\n        },\n        {\n          label: '<span>Login</span>',\n          className: 'loggedOut',\n          //visible: !bp.apps.client.isLoggedIn(), // Only show if logged out\n          click: () => bp.open('buddylist')\n        },\n        {\n          label: '<span class=\"loggedIn\">Logout</span>',\n          //visible: bp.apps.client.isLoggedIn(), // Only show if logged in\n          click: () => {\n            if (bp.logout) {\n              bp.logout();\n            }\n            //bp.apps.client.logout();\n            // Close all chat windows and ponds\n            bp.apps.ui.windowManager.windows.forEach((window) => {\n              if (window.app === 'buddylist' && (window.type === 'buddy' || window.type === 'pond')) {\n                window.close();\n              }\n              if (window.app === 'pond') {\n                window.close();\n              }\n            });\n          }\n        }\n      ]\n    },\n    {\n      label: 'Window',\n      className: \"desktop-only\",\n      submenu: [\n        { label: 'Full Screen', click: () => bp.apps.ui.toggleFullScreen() },\n        {\n          label: 'Hide All Windows',\n          click: () => bp.apps.ui.windowManager.minimizeAllWindows()\n        },\n        /*\n        {\n            label: 'Set Active Window to Wallpaper',\n            disabled: true,\n            click: () => {\n                if (!desktop.ui.wallpaperWindow) {\n                    desktop.ui.wallpaperWindow = true;\n                    desktop.ui.removeWindowWallpaper();\n                    desktop.ui.setActiveWindowAsWallpaper();\n                    $('.setWindowAsWallpaper').html('Remove Window as Wallpaper');\n                } else {\n                    desktop.ui.wallpaperWindow = false;\n                    desktop.ui.removeWindowWallpaper();\n                    $('.setWindowAsWallpaper').html('Set Active Window to Wallpaper');\n                }\n                return false;\n            }\n        } */\n\n      ]\n    },\n    {\n      label: '<span style=\"display:flex;\">$GBP&nbsp; <span id=\"menu-bar-coin-balance\" class=\"odometer\">0</span></span>',\n      submenu: [\n        {\n          label: 'View Coin Balance',\n          closeMenu: true,\n          click: () => bp.open('portfolio')\n        },\n        /*\n        {\n          label: 'Buy Coins',\n          click: () => bp.open('buycoins')\n        },\n        */\n        {\n          label: 'Send Coins',\n          closeMenu: true,\n          click: () => bp.open('portfolio', { context: '#portfolio-transfer' })\n        }\n      ]\n    },\n    {\n      className: 'loggedIn',\n      label: `\n              <span>Reward: <span id=\"menu-bar-coin-reward-coindown\" class=\"countdown-date\">0:59</span></span>\n              <!-- <span class=\"loggedOut\">Login to get Coin Rewards</span> -->\n            `,\n    },\n    /*\n    {\n      label: 'Help',\n      click: () => bp.open('help')\n    },\n    */\n\n    { label: '', flex: 1 }, // empty space\n\n\n    { label: selectMusicPlaylist, className: \"desktop-only\" },\n\n    // { label: selectTheme },\n    // { label: desktopSettings },\n    {\n      label: selectDesktopSettings,\n      /*\n      click: () => {\n        // open the personalize desktop window\n        bp.open('profile', { context: 'themes' });\n      }\n      */\n    },\n\n    // { label: networkStatsStr },\n    {\n      label: sourceCodeStr,\n      click: async (ev) => {\n        // alert('click')\n        let target = ev.target;\n        let url = $(target).data('link');\n        if (!url) {\n          // check if tag has href attribute\n          url = $(target).attr('href');\n        }\n\n        if (window.discordMode) {\n          await window.discordSdk.commands.openExternalLink({\n            url: url\n          });\n          return;\n        } else {\n          window.open(url, '_blank');\n        }\n\n\n        // open a new window to https://github.com/buddypond/buddypond\n        // let url = 'https://github.com/buddypond/buddypond';\n        // window.open(url, '_blank');\n      }\n    },\n    {\n      label: volumeStr,\n      click: (e) => {\n        console.log('Volume toggle clicked');\n        toggleVolumeSlider(e);\n      }\n\n    },\n\n\n    { label: selectLightMode },\n\n\n    { label: clockStr }\n  ];\n\n  const toggleVolumeSlider = (e) => {\n    const $container = $('.volumeSliderContainer');\n\n    if ($container.is(':visible')) {\n      if ($(e.target).closest('.volume-enabled-checkbox').length) {\n        return;\n      }\n      // only slide up if e.target is not volumeSliderContainer or child of volumeSliderContainer\n      if (!$(e.target).closest('.volumeSliderContainer').length) {\n        $container.slideUp(111);\n        return;\n      }\n    }\n\n    $container.slideDown(111);\n\n    let currentVolume = bp.get('audio_volume') * 100;\n    if (isNaN(currentVolume)) currentVolume = 100;\n\n    $(\"#toggleVolumeSlider\").slider({\n      min: 0,\n      max: 100,\n      value: currentVolume,\n      create: function () {\n        let handle = $(this).find('.ui-slider-handle');\n        handle.append('<span class=\"slider-value\">' + currentVolume + '</span>');\n      },\n      slide: function (event, ui) {\n        bp.set('audio_volume', ui.value / 100);\n        // show the slider-value\n        if (ui.value === 0) {\n          $('.volumeFull').hide();\n          $('.volumeMuted').show();\n          // uncheck the enableVolume checkbox\n          $('#enableVolume').prop('checked', true);\n          bp.set('audio_enabled', false);\n\n        }\n        if (ui.value > 0) {\n          $('.volumeFull').show();\n          $('.volumeMuted').hide();\n          // check the enableVolume checkbox\n          $('#enableVolume').prop('checked', false);\n          bp.set('audio_enabled', true);\n\n          console.log(\"ENABLED AUDIO\");\n          // trigger change event\n        }\n        $(this).find('.slider-value').show().text(ui.value);\n      },\n      stop: (event, ui) => {\n\n        if (ui.value > 0) {\n          bp.set('audio_enabled', true);\n\n          $('.volumeFull').show();\n          $('.volumeMuted').hide();\n          // check the enableVolume checkbox\n          $('#enableVolume').prop('checked', false);\n          console.log(\"ENABLED AUDIO\");\n          // trigger change event\n        }\n\n        console.log('play sound at volume', bp.get('audio_volume'));\n        console.log('audio_enabled', bp.get('audio_enabled'));\n        bp.play('desktop/assets/audio/VOLUME-ON.mp3', { tryHard: Infinity });\n        setTimeout(() => {\n          $('.slider-value').hide();\n\n        }, 444);\n      }\n    });\n  };\n\n\n  return menuTemplate;\n\n}","/* MenuBar.js - Marak Squires - BuddyPond - 2023 */\nimport defaultMenuBar from \"./lib/defaultMenuBar.js\";\n\nexport default class MenuBar {\n    constructor(bp, options = {}) {\n        this.bp = bp;\n        this.options = options;\n        this.menus = {}; // Store named menus\n        this.currentMenuData = []; // Active menu structure\n        this.menuBarElement = null; // Reference to menu DOM element\n    }\n\n    async init() {\n        await this.bp.appendCSS('/v5/apps/based/menubar/menubar.css');\n        this.bp.on('auth::logout', 'reset-menu', () => $('.me_title').html('Sign In'));\n        this.load();\n    }\n\n    load(menuData = {}, parent = document.body) {\n        this.currentMenuData = defaultMenuBar(this.bp);\n        this.renderMenu(parent);\n    }\n\n    setDefaultMenu() {\n        this.currentMenuData = defaultMenuBar(this.bp);\n        this.renderMenu();\n    }\n\n    setMenu(menuName, menuItems) {\n        if (menuName) {\n            if (menuItems) {\n                this.menus[menuName] = menuItems; // Add/update a named menu\n            } else {\n                delete this.menus[menuName]; // Remove a named menu\n            }\n        } else {\n            this.currentMenuData = menuItems || []; // Replace the entire menu\n        }\n\n        // Ensure that the most relevant menu data is used\n        const menuData = this.currentMenuData.length\n            ? this.currentMenuData\n            : Object.values(this.menus).flat();\n\n        console.log('new menuData', menuData);\n        this.renderMenu(undefined, menuItems);\n    }\n\n    renderMenu(parent = document.body, menuData = this.currentMenuData) {\n        if (this.menuBarElement) {\n            this.menuBarElement.remove();\n        }\n\n        //console.log('Rendering menu with data:', menuData);\n\n        this.menuBar = new MenuBarClass(menuData).createMenu();\n        this.menuBarElement = this.menuBar.menuBarElement;\n        // console.log('new menuBarElement', parent, this.menuBarElement);\n        parent.appendChild(this.menuBarElement);\n\n        if (this.bp.isMobile()) {\n            // $('.desktop-menu-bar').hide();\n            $('.desktop-only').remove();\n        }\n\n        // update the default values based on local storage settings\n        // TODO: we may want to move this somewhere else\n        // console.log('setting current theme', this.bp.settings.active_theme);\n        if (this.bp.settings.active_theme) {\n            $('.selectTheme', this.menuBarElement).val(this.bp.settings.active_theme);\n        } else {\n            $('.selectTheme', this.menuBarElement).val('Dark');\n        }\n        // console.log('setting audio', this.bp.settings.audio_enabled);\n        if (this.bp.settings.audio_enabled === false) {\n            $('.volumeFull').hide();\n            $('.volumeMuted').show();\n        } else {\n            $('.volumeFull').show();\n            $('.volumeMuted').hide();\n        }\n        // alert(this.bp.settings.audio_enabled);\n\n        $('.selectLightMode i', this.menuBarElement).on('click', function (e) {\n            let mode = $(e.target).data('mode');\n            //alert('set the mode to ' + mode);\n            bp.apps.themes.applyTheme(mode);\n        });\n\n        // Delegate change event for .selectPlaylist\n        $('.selectPlaylist', this.menuBarElement).on('change', function () {\n            $('#soundcloudiframe').remove();\n            $('#soundcloudplayer').html('');\n            /*\n            if (desktop.app.soundcloud) {\n                desktop.app.soundcloud.embeded = false;\n            }\n            desktop.ui.openWindow('soundcloud', { playlistID: $(this).val() });\n            */\n            if (bp.apps.soundcloud) {\n                bp.apps.soundcloud.soundCloudEmbeded = false; // reload\n            }\n            bp.open('soundcloud', { playlistID: $(this).val() });\n        });\n\n\n        $('.icon.trigger').on('click', function (e) {\n            e.stopPropagation(); // Prevent click from bubbling to document\n            $(this).siblings('.dropdown-menu').slideToggle(200);\n        });\n\n        // Handle option selection\n        $('.desktop-settings-dropdown-menu li').on('click', async (ev) => {\n            const value = $(ev.target).data('value');\n            const text = $(ev.target).text();\n            // Update the trigger text/icon if desired\n            /*\n            $(this).closest('.dropdown-wrapper').find('.icon.trigger').html(\n                `<i class=\"fa-duotone fa-regular fa-desktop\"></i> ${text}`\n            );\n            */\n            // Hide the dropdown\n            $(ev.target).parent().slideUp(200);\n            // Handle the selected value (e.g., perform an action)\n            console.log('Selected:', value);\n\n            if (!value) {\n                return;\n            }\n            if (value === 'urlWallpaper') {\n                // open profile settings to themes, select url option\n                await this.bp.open('profile', { context: 'themes' });\n                $('#wallPaperRadiourl').click()\n                // bp.apps.wallpaper.setWallpaper();\n                return;\n            }\n            if (value === 'open') {\n                // open the desktop settings\n                bp.open('profile', { context: 'themes' });\n                console.log('Opening desktop settings', this);\n                this.menuBar.closeMobileMenu();\n                return;\n            }\n\n            if (value === 'default') {\n                bp.apps.wallpaper.setDefaultWallpaper();\n            }\n\n            // clear wallpaper_url if exists\n            // bp.set('wallpaper_url', null);\n            bp.set('wallpaper_name', value);\n        });\n\n        $('.select-playlist-dropdown-menu li').on('click', function () {\n            const value = $(this).data('value');\n            const text = $(this).text();\n            // Update the trigger text/icon if desired\n            /*\n            $(this).closest('.dropdown-wrapper').find('.icon.trigger').html(\n                `<i class=\"fa-duotone fa-regular fa-desktop\"></i> ${text}`\n            );\n            */\n            // Hide the dropdown\n            $(this).parent().slideUp(200);\n            // Handle the selected value (e.g., perform an action)\n            console.log('Selected:', value);\n\n            $('#soundcloudiframe').remove();\n            $('#soundcloudplayer').html('');\n            /*\n            if (desktop.app.soundcloud) {\n                desktop.app.soundcloud.embeded = false;\n            }\n            desktop.ui.openWindow('soundcloud', { playlistID: $(this).val() });\n            */\n            if (bp.apps.soundcloud) {\n                bp.apps.soundcloud.soundCloudEmbeded = false; // reload\n            }\n            bp.open('soundcloud', { playlistID: value });\n\n        });\n\n        $('#enableVolume').on('change', function () {\n\n            if ($(this).is(':checked')) {\n                $('.volumeFull').hide();\n                $('.volumeMuted').show();\n                bp.set('audio_enabled', false);\n            } else {\n                $('.volumeFull').show();\n                $('.volumeMuted').hide();\n                bp.set('audio_enabled', true);\n                bp.play('desktop/assets/audio/VOLUME-ON.mp3', { tryHard: Infinity });\n            }\n        });\n\n\n        let hideVolumeTimeout;\n\n          $('.volumeSliderContainer').on('mouseleave', (ev) => {\n            hideVolumeTimeout = setTimeout(() => {\n              $('.volumeSliderContainer').slideUp(111);\n            }, 666);\n          });\n\n          $('.volumeSliderContainer').on('mouseenter', () => {\n            clearTimeout(hideVolumeTimeout);\n          });\n\n\n        // Close dropdown when clicking outside\n        $(document).on('click', function (e) {\n          console.log('Document click', e.target);\n            // check if target is .volume-enabled-checkbox\n            if (!$(e.target).closest('.dropdown-wrapper').length) {\n                $('.dropdown-menu').slideUp(200);\n            }\n            if (!$(e.target).closest('#toggleVolumeSlider').length) {\n              // if element is volumeSliderContainer or child of volumeSliderContainer, do nothing\n              if (!$(e.target).closest('.volumeSliderContainer').length) {\n                  console.log('Hiding volume slider');\n                  $('.volumeSliderContainer').hide();\n              }\n            }\n        });\n\n        // TODO: could move this elsewhere\n        let countDownEl = $('#menu-bar-coin-reward-coindown');\n        // console.log('Setting countdown for menu bar coin reward', expiry, countDownEl.length);\n        // set data-ctime to the current time\n        function startCountdown() {\n            const rewardPeriod = 60 * 1000; // 60 seconds\n            const expiry = new Date(Date.now() + rewardPeriod);\n            // console.log(\"Starting countdown for menu bar coin reward\", expiry, countDownEl.length);\n\n            function restartCountdown($el) {\n                bp.apps.rewards.requestReward();\n\n                setTimeout(() => {\n                    const newExpiry = new Date(Date.now() + rewardPeriod);\n                    bp.apps.ui.countdownManager.startCountdown($el, newExpiry, restartCountdown);\n                }, 10);\n            }\n\n            bp.apps.ui.countdownManager.startCountdown(countDownEl, expiry, restartCountdown);\n        }\n\n        if (this.bp.qtokenid) {\n            // will most likely not hit this case, since the menu bar is loaded before login completes\n            startCountdown();\n        } else {\n            // in most cases we will hit this case, where login token is received after menu bar is loaded\n            $('.loggedIn').flexHide();\n            // create event listen for 'auth::login' to start the countdown\n            this.bp.on('auth::qtoken', 'start-rewards-timer', () => {\n                // console.log('Starting rewards timer after login');\n                startCountdown();\n            });\n        }\n\n        /*\n        if (!desktop.settings.audio_enabled) {\n            $('.volumeFull').hide();\n            $('.volumeMuted').show();\n        } else {\n            $('.volumeFull').show();\n            $('.volumeMuted').hide();\n        }\n        */\n\n    }\n}\n\nclass MenuBarClass {\n    constructor(menuTemplate, options = {}) {\n        this.menuTemplate = menuTemplate;\n        this.menuBarElement = null;\n        this.id = options.id || \"menu-bar\";\n    }\n\n    createMenu() {\n        this.menuBarElement = document.createElement(\"div\");\n        this.menuBarElement.classList.add(\"menu-bar\");\n        this.menuBarElement.classList.add(\"desktop-menu-bar\");\n        this.menuBarElement.id = this.id;\n\n        /*\n        const toggleButton = document.createElement(\"div\");\n        toggleButton.className = \"mobile-menu-toggle\";\n        toggleButton.innerHTML = \"â˜°\";\n        toggleButton.onclick = (e) => {\n            e.stopPropagation();\n\n            const $menu = $(this.menuBarElement);\n\n            if ($menu.hasClass(\"mobile-active\")) {\n                // Animate out (slide off left)\n                $menu.animate({ left: \"-100%\" }, 300, () => {\n                    $menu.removeClass(\"mobile-active\");\n                });\n            } else {\n                // Prepare for entry: move off-screen, then show and animate in\n                $menu\n                    .css({ left: \"-100%\", display: \"flex\" }) // ensure it's ready to animate\n                    .addClass(\"mobile-active\")\n                    .animate({ left: \"0%\" }, 300);\n            }\n        };\n\n        // this.menuBarElement.appendChild(toggleButton);\n        document.body.appendChild(toggleButton);\n        */\n\n\n        this.menuTemplate.forEach(menuItem => this.createMenuItem(menuItem));\n\n        this.menuBarElement.classList.add(\"responsive-ready\");\n\n        this.addGlobalEventListeners();\n\n        return this;\n\n    }\n\n    createMenuItem(menuItem) {\n        const menuButton = document.createElement(\"div\");\n        menuButton.classList.add(\"menu-item\");\n        menuButton.innerHTML = menuItem.label;\n\n        if (menuItem.flex) {\n            menuButton.style.flex = menuItem.flex;\n        }\n\n        if (menuItem.className) {\n            menuButton.classList.add(menuItem.className);\n        }\n\n        if (menuItem.click) {\n            menuButton.onclick = (event) => {\n                event.stopPropagation();\n                menuItem.click(event);\n\n                if (menuItem.closeMenu) {\n                    this.closeMobileMenu();\n                }\n            };\n        }\n\n\n        if (menuItem.submenu) {\n            const submenuContainer = this.createSubMenu(menuItem.submenu);\n            menuButton.appendChild(submenuContainer);\n\n            // ðŸ› ï¸ Handle accordion vs. hover based on screen width\n            const isMobile = window.matchMedia(\"(max-width: 1000px)\").matches;\n\n            if (isMobile) {\n                menuButton.addEventListener(\"click\", (e) => {\n                    e.stopPropagation();\n                    submenuContainer.classList.toggle(\"open\");\n                });\n            } else {\n                // desktop hover behavior\n                menuButton.addEventListener(\"mouseover\", () => submenuContainer.style.display = \"block\");\n                menuButton.addEventListener(\"mouseleave\", () => submenuContainer.style.display = \"none\");\n            }\n        }\n\n        this.menuBarElement.appendChild(menuButton);\n    }\n\n\n    createSubMenu(submenuItems) {\n        const submenuContainer = document.createElement(\"div\");\n        submenuContainer.classList.add(\"submenu\");\n\n        submenuItems.forEach(subItem => {\n            const subMenuItem = document.createElement(\"div\");\n            subMenuItem.classList.add(\"submenu-item\");\n            subMenuItem.innerHTML = subItem.label;\n\n            if (subItem.className) {\n                subMenuItem.classList.add(subItem.className);\n            }\n\n            if (subItem.click) {\n                subMenuItem.onclick = (event) => {\n                    event.stopPropagation();\n                    subItem.click();\n\n                    if (subItem.closeMenu) {\n                        this.closeMobileMenu();\n                    }\n                };\n            }\n            if (subItem.submenu) {\n                const nestedSubMenu = this.createSubMenu(subItem.submenu);\n                subMenuItem.appendChild(nestedSubMenu);\n                subMenuItem.addEventListener(\"mouseover\", () => nestedSubMenu.style.display = \"block\");\n                subMenuItem.addEventListener(\"mouseleave\", () => nestedSubMenu.style.display = \"none\");\n            }\n\n            submenuContainer.appendChild(subMenuItem);\n        });\n\n        return submenuContainer;\n    }\n\n    addGlobalEventListeners() {\n        document.addEventListener(\"click\", (event) => {\n            if (!this.menuBarElement.contains(event.target)) {\n                this.closeAllSubmenus();\n            }\n        });\n\n        document.addEventListener(\"keydown\", (event) => {\n            if (event.key === \"Escape\") {\n                this.closeAllSubmenus();\n            }\n        });\n    }\n\n    closeAllSubmenus() {\n        document.querySelectorAll(\".submenu\").forEach(submenu => submenu.style.display = \"none\");\n    }\n\n    closeMobileMenu() {\n        const $menu = $(this.menuBarElement);\n        if ($menu.hasClass(\"mobile-active\")) {\n            $menu.animate({ left: \"-100%\" }, 300, () => {\n                $menu.removeClass(\"mobile-active\");\n            });\n        }\n    }\n\n}\n"],"names":["defaultMenuBar","bp","menuTemplate","label","submenu","className","closeMenu","click","open","logout","apps","ui","windowManager","windows","forEach","window","app","type","close","toggleFullScreen","minimizeAllWindows","context","flex","async","ev","target","url","$","data","attr","discordMode","discordSdk","commands","openExternalLink","e","console","log","toggleVolumeSlider","$container","is","closest","length","slideUp","slideDown","currentVolume","get","isNaN","slider","min","max","value","create","this","find","append","slide","event","set","hide","show","prop","text","stop","play","tryHard","Infinity","setTimeout","MenuBar","constructor","options","menus","currentMenuData","menuBarElement","init","appendCSS","on","html","load","menuData","parent","document","body","renderMenu","setDefaultMenu","setMenu","menuName","menuItems","Object","values","flat","undefined","hideVolumeTimeout","remove","menuBar","MenuBarClass","createMenu","appendChild","isMobile","settings","active_theme","val","audio_enabled","mode","themes","applyTheme","soundcloud","soundCloudEmbeded","playlistID","stopPropagation","siblings","slideToggle","closeMobileMenu","wallpaper","setDefaultWallpaper","clearTimeout","countDownEl","startCountdown","expiry","Date","now","countdownManager","restartCountdown","$el","rewards","requestReward","newExpiry","qtokenid","flexHide","id","createElement","classList","add","menuItem","createMenuItem","addGlobalEventListeners","menuButton","innerHTML","style","onclick","submenuContainer","createSubMenu","matchMedia","matches","addEventListener","toggle","display","submenuItems","subItem","subMenuItem","nestedSubMenu","contains","closeAllSubmenus","key","querySelectorAll","$menu","hasClass","animate","left","removeClass"],"mappings":"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"}