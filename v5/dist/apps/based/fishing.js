var e=[{name:"Common Carp",rarity:"common",weight:60,minWeight:1,maxWeight:5,baseValue:10},{name:"Bluegill",rarity:"common",weight:50,minWeight:.5,maxWeight:2,baseValue:8},{name:"Smallmouth Bass",rarity:"common",weight:45,minWeight:1,maxWeight:4,baseValue:12},{name:"Perch",rarity:"common",weight:40,minWeight:.5,maxWeight:1.5,baseValue:9},{name:"Spotted Trout",rarity:"uncommon",weight:25,minWeight:2,maxWeight:7,baseValue:25},{name:"Catfish",rarity:"uncommon",weight:20,minWeight:3,maxWeight:10,baseValue:30},{name:"Koi",rarity:"uncommon",weight:18,minWeight:2,maxWeight:5,baseValue:40},{name:"Lionfish",rarity:"uncommon",weight:15,minWeight:1,maxWeight:3,baseValue:35},{name:"Electric Eel",rarity:"rare",weight:10,minWeight:5,maxWeight:15,baseValue:100},{name:"Hammerhead Shark",rarity:"rare",weight:7,minWeight:20,maxWeight:50,baseValue:200},{name:"Giant Squid",rarity:"rare",weight:5,minWeight:80,maxWeight:150,baseValue:300},{name:"Ghost Fish",rarity:"rare",weight:4,minWeight:1,maxWeight:3,baseValue:500},{name:"Ancient Leviathan",rarity:"legendary",weight:1,minWeight:100,maxWeight:300,baseValue:1e3},{name:"Sea Serpent",rarity:"legendary",weight:.5,minWeight:120,maxWeight:400,baseValue:1500},{name:"Kraken",rarity:"legendary",weight:.3,minWeight:200,maxWeight:600,baseValue:2e3},{name:"Mermaid",rarity:"legendary",weight:.2,minWeight:50,maxWeight:100,baseValue:2500},{name:"Coelacanth",rarity:"legendary",weight:.1,minWeight:5,maxWeight:20,baseValue:3e3}],t=[{name:"gold",chance:.05,valueMultiplier:2,effect:"shiny and valuable"},{name:"rainbow",chance:.02,valueMultiplier:3,effect:"magical shimmer"},{name:"chrome",chance:.01,valueMultiplier:4,effect:"ultra reflective"},{name:"radioactive",chance:.005,valueMultiplier:5,effect:"glows in the dark"},{name:"neon",chance:.04,valueMultiplier:2.5,effect:"glows with highlighter colors"},{name:"glitched",chance:.01,valueMultiplier:4.5,effect:"flickers and warps reality"},{name:"frozen",chance:.03,valueMultiplier:2.2,effect:"encased in shimmering ice"},{name:"angelic",chance:.003,valueMultiplier:6,effect:"radiates holy light and song"},{name:"demonic",chance:.002,valueMultiplier:6.66,effect:"burns with infernal flame"},{name:"holographic",chance:.01,valueMultiplier:3.5,effect:"projects a translucent double"},{name:"void",chance:5e-4,valueMultiplier:10,effect:"emanates pure cosmic darkness"},{name:"pixelated",chance:.007,valueMultiplier:2.1,effect:"looks like it's from an 8-bit world"},{name:"royal",chance:.009,valueMultiplier:3.75,effect:"wears a tiny golden crown"},{name:"haunted",chance:.001,valueMultiplier:9,effect:"moans softly and flickers with ghostly energy"}],i={"golden rod":{rarity:"legendary",rarityBoost:{rare:1.5,legendary:2},mutationBoost:.02,durability:10},"basic rod":{rarity:"common",rarityBoost:{},mutationBoost:0,description:"A worn-out but trusty fishing rod. No bonuses.",durability:20},"reinforced rod":{rarity:"uncommon",rarityBoost:{uncommon:1.25,rare:1.1},mutationBoost:.005,description:"Slightly increases the chance of catching rare fish.",durability:25},"cyber rod":{rarity:"epic",rarityBoost:{rare:1.4,legendary:1.5},mutationBoost:.03,description:"A futuristic rod with scanning tech for rare catches.",durability:15},bait:{rarity:"common",rarityBoost:{uncommon:1.25,rare:1.25},mutationBoost:.01,durability:5},"radioactive bait":{rarity:"rare",rarityBoost:{rare:1.2},mutationBoost:.05,description:"Fish seem unnaturally drawn to its toxic glow.",durability:3},"mystery chum":{rarity:"uncommon",rarityBoost:{rare:1.1,legendary:1.1},mutationBoost:.01,description:"Smells... suspicious. Increases odds for strange results.",durability:2},"lucky hat":{rarity:"uncommon",mutationBoost:.05,description:"Increases the chance of catching mutated fish by 5%",durability:15},"pirate eyepatch":{rarity:"rare",rarityBoost:{rare:1.3},description:"Channel your inner pirate. Boosts rare catch odds.",mutationBoost:.01,durability:20},"angler's cloak":{rarity:"epic",rarityBoost:{legendary:1.5},description:"A cloak said to be worn by the Sea King. Doubles legendary odds at night.",mutationBoost:.02,durability:10},"lucky coin":{rarity:"uncommon",mutationBoost:.03,description:"Keeps turning up heads. Boosts mutation chances slightly.",durability:30},"cursed charm":{rarity:"rare",rarityBoost:{rare:1.1,legendary:1.3},mutationBoost:.06,description:"Increases rare and mutation odds, but makes fish harder to reel in.",durability:8},"totem of the deep":{rarity:"legendary",rarityBoost:{rare:2,legendary:2},mutationBoost:.05,description:"Summons the favor of deep-sea spirits. Powerful, but fragile.",durability:3}};const a=Object.keys(i);let r={};r.Fish=e,r.Mutations=t,r.Items=i;let n=Math.random;r.setRandomSeed=function(e){if("number"!=typeof e)throw new Error("Seed must be a number");console.log(`Setting fishing random seed to ${e}`),n=function(){console.log(`Setting random seed to ${e}`);let t=e>>>0;t=1664525*t+1013904223>>>0;let i=t/4294967296;return console.log(`Generated random number: ${i}`),i}},r.clearRandomSeed=function(){n=Math.random},r.weightedRandom=function(e,t="weight",i={}){const a=e.reduce(((e,a)=>{const r=i[a.rarity]||1;return e+a[t]*r}),0),r=n()*a;let o=0;for(const a of e){const e=i[a.rarity]||1;if(o+=a[t]*e,r<o)return a}},r.rollMutation=function(e=0){for(const i of t){const t=i.chance+e;if(n()<t)return i}return null},r.castFishingLine=function(t=[]){if(n()<.05){const e=a[Math.floor(n()*a.length)];return{type:"item",name:e,rarity:i[e]?.rarity,metadata:i[e]||{},durability:i[e]?.durability||0,description:i[e]?.effect||"A useful fishing item!",itemsUsed:t}}let o={},s=0;for(const e of t){const t=i[e];if(t){if(t.rarityBoost)for(const[e,i]of Object.entries(t.rarityBoost))o[e]=(o[e]||1)*i;t.mutationBoost&&(s+=t.mutationBoost)}}const l=r.weightedRandom(e,"weight",o),c=r.rollMutation(s),h=(n()*(l.maxWeight-l.minWeight)+l.minWeight).toFixed(2),m=c?c.valueMultiplier:1,u=Math.round(l.baseValue*m*h);return{type:"fish",name:l.name,rarity:l.rarity,weight:parseFloat(h),mutation:c?c.name:null,value:u,description:c?c.effect:null,itemsUsed:t}};class o{constructor(e,t={}){return this.bp=e,this.options=t,this}async init(){return this.html=await this.bp.load("/v5/apps/based/fishing/fishing.html"),await this.bp.load("/v5/apps/based/fishing/fishing.css"),await this.bp.appendScript("https://cdn.jsdelivr.net/npm/chart.js"),"loaded Fishing"}async open(){if(!this.win){this.win=await this.bp.window(this.window());const e=r.Fish;console.log("Fish data loaded:",e);const t=e.reduce(((e,t)=>(e[t.rarity]=(e[t.rarity]||0)+1,e)),{});console.log("Fish counts by rarity:",t),new Chart(document.getElementById("fishing-chart-fish-rarity"),{type:"doughnut",data:{labels:Object.keys(t),datasets:[{data:Object.values(t),backgroundColor:["#4caf50","#2196f3","#9c27b0","#ff9800"]}]},options:{plugins:{title:{display:!0,text:"Fish Distribution by Rarity"}}}}),console.log("Fishing window opened",r)}return this.win}window(){return{id:"fishing",title:"Fishing",icon:"desktop/assets/images/icons/icon_buddy-frog_64.webp",position:"center",parent:$("#desktop")[0],width:850,height:600,content:this.html,resizable:!0,closable:!0,onClose:()=>{this.win=null}}}}export{o as default};
//# sourceMappingURL=fishing.js.map
