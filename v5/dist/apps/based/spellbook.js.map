{"version":3,"file":"spellbook.js","sources":["../../../apps/based/spellbook/lib/client.js","../../../apps/based/spellbook/lib/spellData.js","../../../apps/based/spellbook/lib/castSpell.js","../../../apps/based/spellbook/spellbook.js","../../../apps/based/spellbook/lib/calculateCost.js","../../../apps/based/spellbook/lib/submitFormHandler.js","../../../apps/based/spellbook/lib/updateConfigForm.js"],"sourcesContent":["const client = {};\n\n// admin client endpoint\nclient.endpoint = buddypond.adminEndpoint;\n\nclient.apiRequest = async (uri, method = 'GET', data = null) => {\n\n  const options = {\n    method: method\n  };\n\n  let headers = {\n    \"Accept\": \"application/json\",\n    \"Content-Type\": \"application/json; charset=utf-8\"\n  };\n  if (buddypond.qtokenid) {\n    headers[\"Authorization\"] = `Bearer ${buddypond.qtokenid}`; // âœ… Use Authorization header\n    headers[\"X-Me\"] = buddypond.me; // âœ… Use X-Me header\n  }\n\n\n  if (data) {\n    options.body = JSON.stringify(data);\n  }\n\n  options.headers = headers;\n\n  let url = `${client.endpoint}${uri}`;\n  console.log('admin client making api request', url, options);\n\n\n  try {\n    const response = await fetch(url, options);\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error in API request:', error);\n    throw error;\n  }\n\n};\n\nexport default client;","export default {\n  spells: [\n    {\n      name: 'zalgo',\n      label: 'Zalgo',\n      icon: 'ðŸ‘¹',\n      description: 'Corrupts text with chaotic glyphs.',\n      cost: 10,\n      costText: 'ðŸª™3',\n      costSymbol: 'B.webp,B.webp',\n      config: {\n        targets: ['self', 'buddy'],\n        intensity: { type: 'number', label: 'Intensity', value: 10, min: 1, max: 50 },\n      },\n    },\n    /*\n    {\n      name: 'ebublio',\n      description: 'Traps target in a bubble.',\n      cost: 60,\n      costText: 'ðŸª™2',\n      config: { duration: { type: 'number', label: 'Duration (seconds)', value: 30, min: 10, max: 300 } },\n    },\n    */\n    {\n      name: 'cure',\n      label: 'Cure',\n      icon: 'ðŸ’Š',\n      description: 'Removes a curse from the target.',\n      cost: 20,\n      costText: 'ðŸª™4',\n      costSymbol: 'W.webp',\n      config: { targets: ['self'] },\n    },\n    {\n      name: 'rickroll',\n      label: 'Rickroll',\n      icon: 'ðŸŽµ',\n      description: 'Plays a classic prank video.',\n      cost: 10,\n      costText: 'ðŸª™1',\n      costSymbol: 'U.webp',\n      config: {\n        targets: ['self'],\n        url: { type: 'text', label: 'Video URL', value: 'https://youtu.be/dQw4w9WgXcQ' },\n      },\n    },\n    {\n      name: 'forbiddenRickRoll',\n      label: 'Forbidden Rickroll',\n      icon: 'ðŸ”’',\n      description: 'An inescapable prank video.',\n      cost: 30,\n      costText: 'ðŸª™2',\n      costSymbol: 'B.webp,U.webp,G.webp',\n      config: { targets: ['self'] },\n    },\n    {\n      name: 'lightning',\n      label: 'Lightning',\n      icon: 'âš¡ï¸',\n      description: 'Strikes with a dazzling bolt.',\n      cost: 80,\n      costText: 'ðŸª™3',\n      costSymbol: 'R.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        intensity: { type: 'number', label: 'Intensity', value: 5, min: 1, max: 10 },\n      },\n    },\n    {\n      name: 'fireball',\n      label: 'Fireball',\n      icon: 'ðŸ”¥',\n      description: 'Hurls a fiery projectile.',\n      cost: 80,\n      costText: 'ðŸª™3',\n      costSymbol: 'R.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        power: { type: 'number', label: 'Power', value: 5, min: 1, max: 10 },\n      },\n    },\n    {\n      name: 'freeze',\n      label: 'Freeze',\n      icon: 'â„ï¸',\n      description: 'Encases the target in ice.',\n      cost: 80,\n      costText: 'ðŸª™3',\n      costSymbol: 'U.webp,U.webp,U.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        duration: { type: 'number', label: 'Duration (seconds)', value: 5, min: 1, max: 10 },\n      }\n    },\n    {\n      name: 'earthquake',\n      label: 'Earthquake',\n      icon: 'ðŸŒ',\n      description: 'Shakes the ground beneath.',\n      cost: 80,\n      costText: 'ðŸª™3',\n      costSymbol: 'R.webp,G.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        magnitude: { type: 'number', label: 'Magnitude', value: 5, min: 1, max: 10 },\n      },\n    },\n    {\n      name: 'flood',\n      label: 'Flood',\n      icon: 'ðŸŒŠ',\n      description: 'Covers the area in water.',\n      cost: 80,\n      costText: 'ðŸª™3',\n      costSymbol: 'U.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        depth: { type: 'number', label: 'Depth', value: 5, min: 1, max: 10 },\n      },\n    },\n    {\n      name: 'vortex',\n      label: 'Vortex',\n      icon: 'ðŸŒªï¸',\n      description: 'Creates a swirling wind.',\n      cost: 80,\n      costText: 'ðŸª™3',\n      costSymbol: 'U.webp,R.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        strength: { type: 'number', label: 'Strength', value: 5, min: 1, max: 10 },\n      },\n    },\n    {\n      name: 'barrelRoll',\n      label: 'Barrel Roll',\n      icon: 'ðŸŽ¢',\n      description: 'Performs a barrel roll.',\n      cost: 10,\n      costText: 'ðŸª™1',\n      costSymbol: 'U.webp, R.webp',\n      config: { targets: ['self', 'buddy', 'pond'] },\n    },\n    {\n      name: 'death',\n      label: 'Death',\n      icon: 'ðŸ’€',\n      description: 'Causes the target to die.',\n      cost: 100,\n      costText: 'ðŸª™5',\n      costSymbol: 'B.webp,R.webp',\n      config: { targets: ['self', 'buddy'] }\n    },\n    {\n      name: 'confetti',\n      label: 'Confetti',\n      icon: 'ðŸŽ‰',\n      description: 'Covers the area in confetti.',\n      cost: 20,\n      costText: 'ðŸª™2',\n      costSymbol: 'R.webp, W.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        particleCount: { type: 'number', label: 'Particle Count', value: 100, min: 10, max: 500 },\n        duration: { type: 'number', label: 'Duration (seconds)', value: 5, min: 1, max: 10 },\n      } \n    },\n    {\n      name: 'rainbow',\n      label: 'Rainbow',\n      icon: 'ðŸŒˆ',\n      description: 'Creates a beautiful rainbow.',\n      cost: 30,\n      costText: 'ðŸª™2',\n      costSymbol: 'U.webp,G.webp, W.webp, R.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        duration: { type: 'number', label: 'Duration (seconds)', value: 5, min: 1, max: 10 },\n      }\n    },\n    /*\n    {\n      name: 'pixelate',\n      label: 'Pixelate',\n      icon: 'ðŸ–¼ï¸',\n      description: 'Applies a pixelation effect.',\n      cost: 50,\n      costText: 'ðŸª™2',\n      costSymbol: 'B.webp,G.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        intensity: { type: 'number', label: 'Intensity', value: 5, min: 1, max: 10 },\n        duration: { type: 'number', label: 'Duration (seconds)', value: 5, min: 1, max: 10 },\n      }\n    },\n    {\n      name: 'wavy',\n      label: 'Wavy',\n      icon: 'ðŸŒŠ',\n      description: 'Applies a wavy effect.',\n      cost: 50,\n      costText: 'ðŸª™2',\n      costSymbol: 'U.webp,G.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        intensity: { type: 'number', label: 'Intensity', value: 5, min: 1, max: 10 },\n        duration: { type: 'number', label: 'Duration (seconds)', value: 5, min: 1, max: 10 },\n      }\n    },\n    {\n      name: 'whirlpool',\n      label: 'Whirlpool',\n      icon: 'ðŸŒªï¸',\n      description: 'Creates a swirling whirlpool effect.',\n      cost: 50,\n      costText: 'ðŸª™2',\n      costSymbol: 'U.webp,U\\.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        intensity: { type: 'number', label: 'Intensity', value: 5, min: 1, max: 10 },\n        duration: { type: 'number', label: 'Duration (seconds)', value: 5, min: 1, max: 10 },\n      }\n    },\n    */\n    /*\n    {\n      name: 'explode',\n      label: 'Explode',\n      icon: 'ðŸ’¥',\n      description: 'Causes a small explosion.',\n      cost: 100,\n      costText: 'ðŸª™5',\n      costSymbol: 'R.webp,G.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        radius: { type: 'number', label: 'Explosion Radius', value: 5, min: 1, max: 10 },\n        power: { type: 'number', label: 'Explosion Power', value: 5, min: 1, max: 10 },\n      }\n    },\n    */\n    {\n      name: 'alert',\n      label: 'Alert',\n      icon: 'ðŸ“¢',\n      description: 'Displays a custom message.',\n      cost: 10,\n      costText: 'ðŸª™1',\n      costSymbol: 'W.webp',\n      config: {\n        targets: ['self', 'buddy'],\n        text: { type: 'text', label: 'Message', value: 'You have been cursed!' },\n      },\n    },\n    {\n      name: 'logout',\n      label: 'Logout',\n      icon: 'ðŸšª',\n      description: 'Forces the target to log out.',\n      cost: 250,\n      costText: 'ðŸª™5',\n      costSymbol: 'B.webp',\n      config: { },\n    },\n  ],\n\n  curses: [\n    {\n      name: 'babel',\n      label: 'Babel.js',\n      icon: 'ðŸ—£ï¸',\n      description: 'Scrambles communication.',\n      cost: 120,\n      costText: 'ðŸª™3',\n      costSymbol: 'U.webp, B.webp',\n      config: {\n        targets: ['self'],\n        duration: { type: 'number', label: 'Curse Duration', value: 1, min: 1, max: 5 },\n      },\n    },\n    {\n      name: 'riddikulus',\n      label: 'Riddikulus',\n      icon: 'ðŸ˜‚',\n      description: 'Turns fears into something funny.',\n      cost: 60,\n      costText: 'ðŸª™2',\n      costSymbol: 'U.webp, B.webp',\n      config: {\n        targets: ['self'],\n        duration: { type: 'number', label: 'Duration (seconds)', value: 1, min: 1, max: 5 },\n      },\n    },\n    {\n      name: 'no-uploads',\n      label: 'No Uploads',\n      icon: 'ðŸš«',\n      description: 'Prevents uploads for a duration.',\n      cost: 150,\n      costText: 'ðŸª™5',\n      costSymbol: 'B.webp, W.webp',\n      config: {\n        duration: { type: 'number', label: 'Curse Duration', value: 1, min: 1, max: 5 },\n      },\n    },\n    {\n      name: 'banhammer',\n      label: 'Banhammer',\n      icon: 'ðŸ”¨',\n      description: 'Temporarily bans the target.',\n      cost: 1000,\n      costText: 'ðŸª™10',\n      costSymbol: 'W.webp,B.webp',\n      config: {\n        duration: { type: 'number', label: 'Ban Duration (seconds)', value: 600, min: 300, max: 86400 },\n      },\n    },\n  ],\n\n  memes: [\n    {\n      name: 'chicken-jockey',\n      label: 'Chicken Jockey',\n      icon: 'ðŸ”',\n      description: 'Summons a chicken jockey.',\n      cost: 10,\n      costText: 'ðŸª™1',\n      costSymbol: 'G.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        duration: { type: 'number', label: 'Duration (seconds)', value: 5, min: 1, max: 10 },\n      },\n    },\n    {\n      name: 'hamster-dance',\n      label: 'Hamster Dance',\n      icon: 'ðŸ¹',\n      description: 'Plays a funny hamster dance sound.',\n      cost: 10,\n      costText: 'ðŸª™1',\n      costSymbol: 'G.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        volume: { type: 'number', label: 'Volume', value: 5, min: 1, max: 10 },\n      },\n    },\n    {\n      name: 'cappuccino-assassino',\n      label: 'Cappuccino Assassino',\n      icon: 'â˜•',\n      description: 'Summons a cappuccino assassin.',\n      cost: 10,\n      costText: 'ðŸª™1',\n      costSymbol: 'B.webp, R.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        duration: { type: 'number', label: 'Duration (seconds)', value: 5, min: 1, max: 10 },\n      },\n    },\n    {\n      name: 'peanut-butter-jelly-time',\n      label: 'Peanut Butter Jelly Time',\n      icon: 'ðŸž',\n      description: 'Plays a funny peanut butter jelly time sound.',\n      cost: 10,\n      costText: 'ðŸª™1',\n      costSymbol: 'R.webp, G.webp',\n      config: {\n        targets: ['self', 'buddy', 'pond'],\n        volume: { type: 'number', label: 'Volume', value: 5, min: 1, max: 10 },\n      },\n    },\n  ],\n};\n","import spellData from './spellData.js';\n\n\nexport default async function castSpell(targetType, targetName, spellName, spellData) {\n  console.log(spellName, castSpell);\n  if (spellName.length > 0 && castSpell.length > 0) {\n\n    // check if buddy is not logged in, if so cast spell directly\n    if (this.bp.me === 'Guest' || !this.bp.me) {\n\n      let data = {\n        spell: spellName,\n        targetType,\n        target: targetName,\n        type: spellData.type,\n        config: spellData.config || {}\n      }\n      await runSpell.call(this, data);\n      return;\n\n    }\n\n    // if Buddy fails role check, reflect the spell back onto them\n    let result;\n    try {\n      result = await this.client.apiRequest(`/spellbook/cast-spell/${targetType}/${targetName}/${spellName}`, 'POST', spellData)\n    } catch (err) {\n      console.error('Error casting spell:', err);\n      result = {\n        error: err.message\n      };\n      if (err.message === 'HTTP error! status: 401') {\n        result.error = 'Please log in to cast spells.';\n      }\n\n    }\n    console.log('castSpell result', result);\n    return result;\n  }\n}\n\nasync function runSpell(data) {\n    // dynamically import the spell\n    try {\n        let spellModule = await this.bp.importModule(`/v5/apps/based/spellbook/spells/${data.spell}/${data.spell}.js`, {}, false);\n        spellModule.default.call(this);\n    }\n    catch (error) {\n        console.log('Error importing spell module:', error);\n    }\n}\n","import client from './lib/client.js';\nimport castSpell from './lib/castSpell.js';\nimport spellData from './lib/spellData.js';\nimport calculateCost from './lib/calculateCost.js';\nimport submitFormHandler from './lib/submitFormHandler.js';\nimport updateConfigForm from './lib/updateConfigForm.js';\n\nfunction updateSpellButtons(spellType, container) {\n  const currentTargetType = $('#spellTargetType').val() || 'buddy'; // fallback\n  const spells = spellData[spellType];\n  // console.log('updateSpellButtons', spellType, currentTargetType, spells);\n\n  const buttons = Array.from(container.querySelectorAll('.spellbook-spell-button'));\n\n  buttons.forEach(button => {\n    const spellName = button.dataset.name;\n    const spell = spells.find(s => s.name === spellName);\n\n    if (!spell || !spell.config || !spell.config.targets && this.bp.me !== 'Marak') { // TODO: admin rbac check\n      button.disabled = true;\n      button.classList.remove('valid-target');\n      button.classList.add('invalid-target');\n      button.title = `Spell ${spellName} has no allowed targets for you.`;\n      return;\n    }\n\n    if (spell.config?.targets?.includes(currentTargetType) || this.bp.me === 'Marak') { // TODO: admin rbac check\n      button.disabled = false;\n      button.classList.add('valid-target');\n      button.classList.remove('invalid-target');\n      button.title = ''; // optional: add a helpful hint here\n    } else {\n      button.disabled = true;\n      button.classList.remove('valid-target');\n      button.classList.add('invalid-target');\n      button.title = `Valid targets: ${spell.config.targets.join(', ')}`;\n    }\n  });\n\n  // Now sort buttons: enabled first, then alphabetically\n  buttons.sort((a, b) => {\n    const aDisabled = a.disabled ? 1 : 0;\n    const bDisabled = b.disabled ? 1 : 0;\n\n    if (aDisabled !== bDisabled) {\n      return aDisabled - bDisabled;\n    }\n\n    const aLabel = a.querySelector('.spell-label').textContent.toLowerCase();\n    const bLabel = b.querySelector('.spell-label').textContent.toLowerCase();\n    return aLabel.localeCompare(bLabel);\n  });\n\n  // Re-append sorted buttons\n  buttons.forEach(button => container.appendChild(button));\n}\n\n\nfunction renderSpellButtons(spellType, container, onSelect) {\n  container.innerHTML = '';\n  const spells = spellData[spellType];\n  spells.forEach(spell => {\n\n    const btn = document.createElement('button');\n    btn.type = 'button';\n    btn.className = 'spellbook-spell-button';\n    btn.dataset.name = spell.name;\n\n    const icon = document.createElement('div');\n    icon.className = 'spell-icon';\n    icon.textContent = spell.icon || 'âœ¨'; // fallback icon\n\n    const label = document.createElement('div');\n    label.className = 'spell-label';\n    label.textContent = `${spell.label || spell.name}`;\n\n    btn.appendChild(icon);\n    btn.appendChild(label);\n\n    if (!spell.config || !spell.config.targets && this.bp.me !== 'Marak') { // TODO: admin rbac check\n      btn.disabled = true;\n    }\n    btn.addEventListener('click', () => {\n      onSelect(spell);\n      this.applyCooldown(btn, spell.cooldown || 10000); // default cooldown of 1 second\n    });\n    container.appendChild(btn);\n\n\n  });\n\n  // ['self', 'buddy', 'pond'], etc\n  // may contain any combination of 'self', 'buddy', 'pond'\n  let currentTargetType = $('#spellTargetType').val() || 'buddy'; // default to buddy if not set\n  // console.log('currentTargetType', currentTargetType);\n  // TODO: we need to disable the button if currentTargetType is not in spell.config.targets\n  updateSpellButtons.call(this, spellType, container);\n\n}\n\nfunction initSpellbookUI($content, context) {\n  const spellButtonsContainer = $content.querySelector('.spellbook-spells');\n  const tabButtons = $content.querySelectorAll('.spellbook-tab');\n\n  function handleSpellSelection(spell) {\n    const $spellTargetType = $content.querySelector('#spellTargetType');\n    //const $spellCost = $content.querySelector('#spellCost');\n    //$spellCost.textContent = `Cost: ${spell.cost}`;\n    // console.log('Selected spell:', spell);\n\n    // Perform client-side validation of valid spell targets\n    if (spell.config?.targets && this.bp.me !== 'Marak') { // TODO: admin rbac check\n      const availableTargets = spell.config.targets;\n      [...$spellTargetType.options].forEach(opt => {\n        opt.disabled = !availableTargets.includes(opt.value);\n      });\n      if (!availableTargets.includes($spellTargetType.value)) {\n        $spellTargetType.value = availableTargets[0];\n      }\n    }\n    let e = new Event('change');\n    this.submitFormHandler(e, $content, spell);\n  }\n\n  tabButtons.forEach(btn => {\n    btn.addEventListener('click', () => {\n      const type = btn.dataset.type;\n      $('#spellType', $content).val(type);\n      renderSpellButtons.call(this, type, spellButtonsContainer, handleSpellSelection.bind(this));\n    });\n  });\n\n  // Default to first type\n  tabButtons[0].click();\n}\n\nexport default class Spellbook {\n  constructor(bp, options = {}) {\n    this.bp = bp;\n    this.data = spellData;\n    return this;\n  }\n\n  async init() {\n    this.html = await this.bp.load('/v5/apps/based/spellbook/spellbook.html');\n    await this.bp.load('/v5/apps/based/spellbook/spellbook.css');\n\n    this.isUsingInput = false;\n\n    return 'loaded Spellbook';\n  }\n\n  async open(options = {}) {\n\n    let context = null;\n    let output = null;\n\n    if (options.output) { // could be a buddy or a pond or self\n      output = options.output;\n    }\n\n    if (options.context) { // could be a buddyname or pond name\n      context = options.context;\n    }\n\n    if (!this.spellbookWindow) {\n      this.spellbookWindow = this.bp.apps.ui.windowManager.createWindow({\n        id: 'spellbook',\n        title: 'Spellbook',\n        icon: 'desktop/assets/images/icons/icon_spellbook_64.png',\n        x: 250,\n        y: 75,\n        width: 360,\n        height: 500,\n        minWidth: 200,\n        minHeight: 200,\n        parent: $('#desktop')[0],\n        content: this.html,\n        resizable: false, // no works?\n        minimizable: true,\n        maximizable: true,\n        closable: true,\n        focusable: true,\n        maximized: false,\n        minimized: false,\n        onClose: () => {\n          this.spellbookWindow = null;\n        },\n      });\n\n      //\n      // Spellbook eventBind listeners\n      //\n      const $content = this.spellbookWindow.content;\n      initSpellbookUI.call(this, $content, context);\n      // Initialize dropdowns and events\n      $('#spellType', $content).on('change', (e) => {\n        updateSpellsDropdown.call(this, $content);\n      });\n      $('#spellName', $content).on('change', (e) => {\n        updateValidTargets.call(this, $content);\n      });\n      // $('#spellName', $content).on('change', updateConfigForm);\n      $('#spellTargetType', $content).on('change', (e) => {\n        updateTargetVisibility.call(this, $content);\n        updateSpellButtons.call(this, $('#spellType', $content).val(), $content.querySelector('.spellbook-spells'));\n      });\n      // spellDuration is a slider, needs to update on slide\n      $('#spellDuration', $content).on('input', (e) => {\n        const duration = parseInt($(e.target).val(), 10);\n        const spellType = $('#spellType', $content).val();\n        const spellName = $('#spellName', $content).val();\n        const _spellData = this.data[spellType].find((s) => s.name === spellName);\n        const spellCost = calculateCost(_spellData, { duration });\n        $('#spellCost', $content).text(`Total cost: ${spellCost} buddy points`);\n      });\n\n      $('#toggleTargetInput', $content).on('click', () => {\n        this.isUsingInput = !this.isUsingInput;\n        $('#spellTargetName', $content).toggle(!this.isUsingInput);\n        $('#spellTargetInput', $content).toggle(this.isUsingInput);\n        $('#toggleTargetInput', $content).text(this.isUsingInput ? 'Choose from list' : 'Choose name not on list');\n      });\n\n      // Populate active users\n      if (this.bp.apps.buddylist?.data?.activeUsers) {\n        this.bp.apps.buddylist.data.activeUsers.forEach((buddy) => {\n          $('#spellTargetName', $content).append(`<option value=\"${buddy}\">${buddy}</option>`);\n        });\n      }\n\n      // Populate active ponds\n      if (this.bp.apps.buddylist?.data?.activePonds) {\n        this.bp.apps.buddylist.data.activePonds.forEach((pond) => {\n          $('#spellTargetPond', $content).append(`<option value=\"${pond}\">${pond}</option>`);\n        });\n      }\n\n      // Autocomplete for target input\n      $('#spellTargetInput', $content).autocomplete({\n        source: this.bp.apps.buddylist?.data?.activeUsers || [],\n      });\n\n      // Form submission\n      $('#castSpellForm', $content).on('submit', async (e) => {\n        this.submitFormHandler(e, $content);\n      });\n\n      // Orb click (alternative cast trigger)\n      $('.ponderSpellbook', $content).on('click', (e) => {\n        e.preventDefault();\n        $('#castSpellForm', $content).trigger('submit');\n      });\n\n      // Event listeners for dynamic updates\n      this.bp.on('buddy::activeUserAdded', 'update-spellbook-targets', (buddy) => {\n        if (!$(`#spellTargetName option[value=\"${buddy}\"]`, $content).length) {\n          $('#spellTargetName', $content).append(`<option value=\"${buddy}\">${buddy}</option>`);\n        }\n      });\n\n      this.bp.on('pond::activePondAdded', 'update-spellbook-pond-targets', (pond) => {\n        if (!$(`#spellTargetPond option[value=\"${pond}\"]`, $content).length) {\n          $('#spellTargetPond', $content).append(`<option value=\"${pond}\">${pond} Pond</option>`);\n        }\n      });\n\n    }\n\n    if (output) {\n      // select the targetType using the output value\n      $('#spellTargetType', this.spellbookWindow.content).val(output);\n      // trigger change event to update target visibility\n      $('#spellTargetType', this.spellbookWindow.content).trigger('change');\n    }\n    if (context) {\n      if (output === 'buddy') {\n        // select the targetName using the context value\n\n        // ensure that context is in the dropdown, if not add it first\n        if (!$(`#spellTargetName option[value=\"${context}\"]`, this.spellbookWindow.content).length) {\n          $('#spellTargetName', this.spellbookWindow.content).append(`<option value=\"${context}\">${context}</option>`);\n        }\n\n        $('#spellTargetName', this.spellbookWindow.content).val(context);\n        // trigger change event to update target visibility\n        // $('#spellTargetName', this.spellbookWindow.content).trigger('change');\n      }\n      if (output === 'pond') {\n        // select the targetPond using the context value\n        $('#spellTargetPond', this.spellbookWindow.content).show().val(context);\n        // trigger change event to update target visibility\n        // $('#spellTargetPond', this.spellbookWindow.content).trigger('change');\n        setTimeout(() => {\n          // Remark: For some reason there is race condition with the pond dropdown\n          // only when first opening the spellbook, TODO: resolve this\n          $('#spellTargetPond', this.spellbookWindow.content).show();\n        }, 400);\n      }\n\n    }\n\n    let $content = $(this.spellbookWindow.content);\n    updateTargetVisibility.call(this, $content);\n    updateSpellsDropdown.call(this, $content);\n\n\n    return this.spellbookWindow;\n  }\n}\n\n//\n// Spellbook functions\n//\n\n// Update target visibility based on target type\nfunction updateTargetVisibility($content) {\n  // TODO: just use spellTargetName for both pond and buddy\n  const targetType = $('#spellTargetType', $content).val();\n  if (targetType === 'pond') {\n    $('#spellTargetPond', $content).show();\n    $('#spellTargetName', $content).hide();\n    $('.spellTargetSelf', $content).hide();\n    $('#toggleTargetInput', $content).show();\n  }\n\n  if (targetType === 'buddy') {\n    // show the buddy dropdown\n    $('#spellTargetName', $content).show();\n    $('#spellTargetPond', $content).hide();\n    $('.spellTargetSelf', $content).hide();\n    $('#toggleTargetInput', $content).show();\n  }\n\n  if (targetType === 'self') {\n    // hide the buddy and pond dropdowns\n    $('#spellTargetName', $content).hide();\n    $('#spellTargetPond', $content).hide();\n    $('.spellTargetSelf', $content).html(this.bp.me).show();\n    $('#toggleTargetInput', $content).hide();\n    $('.spellTargetNameLabel').show();\n  }\n};\n\n// Populate spells dropdown based on spellType\nfunction updateSpellsDropdown($content) {\n  const spellType = $('#spellType', $content).val();\n  const spellsList = this.data[spellType];\n  const $spellName = $('#spellName', $content);\n\n\n  // console.log('updateSpellsDropdown', spellType, spellsList);\n  $spellName.empty();\n  spellsList.forEach((spell) => {\n\n    let disabled = '';\n\n    // check spell.config.targets\n    if (!spell.config || !spell.config.targets) {\n      disabled = 'disabled';\n    }\n    // TODO: uncomment / add role check from session\n    // Remark: This is validated server-side\n    /*\n    // Ensures that admins can cast any spell\n    */\n    if (this.bp.me === 'Marak') {\n      disabled = '';\n    }\n\n    $spellName.append(`<option ${disabled} value=\"${spell.name}\">(${spell.cost}) - ${spell.label || spell.name}</option>`);\n  });\n\n  // Sort spells\n  // Step 1: Group by disabled status (enabled first, disabled last)\n  let options = $spellName.find('option').get().sort((a, b) => {\n    const aDisabled = $(a).prop('disabled') ? 1 : 0;\n    const bDisabled = $(b).prop('disabled') ? 1 : 0;\n    return aDisabled - bDisabled;\n  });\n\n  // Step 2: Sort alphabetically while preserving groups\n  options = options.sort((a, b) => {\n    const aDisabled = $(a).prop('disabled') ? 1 : 0;\n    const bDisabled = $(b).prop('disabled') ? 1 : 0;\n\n    // Preserve group order: enabled (0) before disabled (1)\n    if (aDisabled !== bDisabled) {\n      return aDisabled - bDisabled;\n    }\n\n    // Sort alphabetically within groups\n    return $(a).val().localeCompare($(b).val(), 'en', { sensitivity: 'base' });\n  });\n\n  // Append sorted options back to the select\n  $spellName.empty().append(options);\n  // prepend as first option\n  $spellName.prepend('<option value=\"\" selected>Choose your spell wisely...</option>');\n\n  // this.updateConfigForm.call($content);\n};\n\nfunction updateValidTargets($content) {\n  const spellName = $('#spellName', $content).val();\n  // get the spellData ref\n  const spellType = $('#spellType', $content).val();\n  const spellsList = this.data[spellType];\n  const spell = spellsList.find((s) => s.name === spellName);\n  const spellConfig = spell.config;\n  const previousTargetType = $('#spellTargetType', $content).val();\n  const previousTargetName = $('#spellTargetName', $content).val();\n\n  // check the spellConfig.targets and then update the targetType dropdown with disabled options such that any values\n  // not found in the spellConfig.targets are disabled\n  // console.log('updateValidTargets', spellName, spellType, spell);\n  const $targetType = $('#spellTargetType', $content);\n  $targetType.empty().append('<option value=\"\">Choose your target wisely...</option>');\n  if (spellConfig && spellConfig.targets) {\n    let allTargets = ['self', 'buddy', 'pond'];\n    allTargets.forEach((value) => {\n      let disabled = 'disabled';\n      if (spellConfig.targets.includes(value)) {\n        disabled = '';\n      }\n      // TODO: uncomment / add role check from session\n      // Remark: This is validated server-side\n      // Ensures that admins can choose any target\n      /*\n      */\n      if (this.bp.me === 'Marak') {\n        disabled = '';\n      }\n      // upperCast first letter\n      const targetLabel = value.charAt(0).toUpperCase() + value.slice(1);\n      $targetType.append(`<option ${disabled} value=\"${value}\">${targetLabel}</option>`);\n    });\n    // if only one targetType, select it\n    if (Object.keys(spellConfig.targets).length === 1) {\n      const targetType = spellConfig.targets[0];\n      // console.log('updateValidTargets - only one targetType', targetType);\n      $targetType.val(targetType);\n      if (targetType === 'self') {\n        // hide the spellTargetName\n        $('#spellTargetName', $content).hide();\n        // show the spellTargetSelf with value as this.bp.me\n        $('.spellTargetSelf', $content).html(this.bp.me).show();\n        $('#toggleTargetInput', $content).hide();\n      } else {\n        // show the spellTargetName\n        $('#spellTargetName', $content).show();\n        // hide the spellTargetSelf\n        $('.spellTargetSelf', $content).hide();\n        $('#toggleTargetInput', $content).show();\n      }\n    } else {\n      // show the spellTargetName\n      $('#spellTargetName', $content).show();\n      // hide the spellTargetSelf\n      $('.spellTargetSelf', $content).hide();\n      $('#toggleTargetInput', $content).show();\n    }\n  } else {\n    $targetType.append('<option disabled value=\"self\">Self</option>');\n  }\n\n  // if the previousTargetType is available in the spellConfig.targets, select it\n  if (spellConfig && spellConfig.targets && spellConfig.targets.includes(previousTargetType)) {\n    $targetType.val(previousTargetType);\n  } else {\n    $targetType.val('');\n  }\n\n}\nfunction applyCooldown(button, durationMs) {\n  button.classList.add('cooldown', 'cooldown-active'); // cooldown-active blocks pointer events\n  button.style.setProperty('--cooldown-time', `${durationMs}ms`);\n\n  const cooldownOverlay = document.createElement('div');\n  cooldownOverlay.className = 'cooldown-overlay';\n  cooldownOverlay.style.animationDuration = `${durationMs}ms`;\n\n  button.appendChild(cooldownOverlay);\n\n  setTimeout(() => {\n    button.classList.remove('cooldown', 'cooldown-active');\n    if (cooldownOverlay.parentElement) {\n      cooldownOverlay.remove();\n    }\n  }, durationMs);\n}\n\n\nSpellbook.prototype.applyCooldown = applyCooldown;\n\nSpellbook.prototype.castSpell = castSpell;\nSpellbook.prototype.client = client;\nSpellbook.prototype.submitFormHandler = submitFormHandler;\nSpellbook.prototype.updateConfigForm = updateConfigForm;","export default function calculateCost(spellData, config) {\n    console.log('calculateCost', spellData, config);\n    const cost = spellData.cost;\n    const duration = config.duration;\n\n    let totalCost = cost * duration;\n\n    return totalCost;\n\n}","export default async function submitFormHandler(e, content, spell) {\n  let $content = $(content);\n    e.preventDefault();\n    // console.log('Submitting spell form...', content, spell);\n    const spellType = $('#spellType', $content).val();\n    //const spellName = $('#spellName', $content).val();\n    let spellName = spell.name;\n    let targetType = $('#spellTargetType', $content).val();\n\n    // console.log(`Submitting spell form for type: ${spellType}, name: ${spellName} and target type: ${targetType}`);\n    const spellDuration = $('#spellDuration', $content).val();\n    // const _spellData = this.data[spellType].find((s) => s.name === spellName);\n\n    let target = null;\n    const config = {};\n\n\n    if (targetType === 'buddy') {\n      target = this.isUsingInput ? $('#spellTargetInput', $content).val() : $('#spellTargetName', $content).val();\n    }\n\n    if (targetType === 'pond') {\n      target = $('#spellTargetPond', $content).val();\n    }\n\n    if (targetType === 'self') {\n      target = this.bp.me; // Use current user\n    }\n\n    /*\n    if (targetType === 'buddy') {\n      target = isUsingInput ? $('#spellTargetInput', $content).val() : $('#spellTargetName', $content).val();\n    } else if (targetType === 'pond' && spellType === 'spell') {\n      target = $('#spellTargetPond', $content).val();\n    } else if (targetType === 'self') {\n      target = this.bp.me; // Use current user\n    }\n    */\n\n    // Collect config values\n    $('#spellConfig input', $content).each(function () {\n      const name = $(this).attr('name').match(/spellConfig\\[(.*)\\]/)[1];\n      config[name] = $(this).val();\n    });\n\n    config.duration = spellDuration;\n\n    // let totalCost = calculateCost(_spellData, config);\n    // console.log(`Casting ${spellName} on ${target} with a total cost of ${totalCost} buddy points.`);\n\n    if (spellName && target) {\n      try {\n        if (targetType === 'self') {\n          targetType = 'buddy'; // self is a special case, but we want to treat it as a buddy for casting\n        }\n        let result = await this.castSpell(targetType, target, spellName, { type: spellType, config });\n        if (result && result.error) {\n          // display error message\n          $('.spell-message', $content).addClass('error');\n          $('.spell-message', $content).text(result.error).show();\n        } else {\n          // display success message\n          $('.spell-message', $content).removeClass('error');\n          $('.spell-message', $content).text('Spell cast successfully!').show();\n        }\n        // this.applyCooldown(spellType, spellName, targetType, target);\n        console.log('Spell cast result:', result);\n      } catch (error) {\n        throw new Error(`Error casting spell: ${error.message}`);\n      }\n\n    } else {\n      alert('Please select a spell and a valid target.');\n    }\n}"," // Populate config form based on selected spell\n export default function updateConfigForm ($content) {\n   const spellName = $('#spellName', $content).val();\n   const spellType = $('#spellType', $content).val();\n   const spellsList = this.data[spellType];\n   const spell = spellsList.find((s) => s.name === spellName);\n   const $config = $('#spellConfig', $content);\n   $config.empty();\n   if (spell && spell.config) {\n     Object.entries(spell.config).forEach(([key, config]) => {\n       if (key === 'targets') {\n         return;\n       }\n       const inputId = `spellConfig-${key}`;\n       const $label = $(`<label for=\"${inputId}\">${config.label}</label>`);\n       let $input;\n       if (config.type === 'number') {\n         $input = $(`<input type=\"number\" id=\"${inputId}\" name=\"spellConfig[${key}]\" value=\"${config.value}\" min=\"${config.min}\" max=\"${config.max}\">`);\n       } else {\n         $input = $(`<input type=\"text\" id=\"${inputId}\" name=\"spellConfig[${key}]\" value=\"${config.value}\">`);\n       }\n       $config.append($label, $input);\n     });\n   }\n}"],"names":["client","endpoint","buddypond","adminEndpoint","apiRequest","async","uri","method","data","options","headers","Accept","qtokenid","me","body","JSON","stringify","url","console","log","response","fetch","ok","Error","status","json","error","spellData","spells","name","label","icon","description","cost","costText","costSymbol","config","targets","intensity","type","value","min","max","power","duration","magnitude","depth","strength","particleCount","text","curses","memes","volume","runSpell","this","bp","importModule","spell","default","call","updateSpellButtons","spellType","container","currentTargetType","$","val","buttons","Array","from","querySelectorAll","forEach","button","spellName","dataset","find","s","disabled","classList","remove","add","title","includes","join","sort","a","b","aDisabled","bDisabled","aLabel","querySelector","textContent","toLowerCase","bLabel","localeCompare","appendChild","renderSpellButtons","onSelect","innerHTML","btn","document","createElement","className","addEventListener","applyCooldown","cooldown","initSpellbookUI","$content","context","spellButtonsContainer","tabButtons","handleSpellSelection","$spellTargetType","availableTargets","opt","e","Event","submitFormHandler","bind","click","Spellbook","constructor","init","html","load","isUsingInput","open","output","spellbookWindow","apps","ui","windowManager","createWindow","id","x","y","width","height","minWidth","minHeight","parent","content","resizable","minimizable","maximizable","closable","focusable","maximized","minimized","onClose","on","updateSpellsDropdown","updateValidTargets","updateTargetVisibility","parseInt","target","spellCost","calculateCost","toggle","buddylist","activeUsers","buddy","append","activePonds","pond","autocomplete","source","preventDefault","trigger","length","show","setTimeout","targetType","hide","spellsList","$spellName","empty","get","prop","sensitivity","prepend","spellConfig","previousTargetType","$targetType","targetLabel","charAt","toUpperCase","slice","Object","keys","prototype","durationMs","style","setProperty","cooldownOverlay","animationDuration","parentElement","castSpell","targetName","result","err","message","spellDuration","each","attr","match","addClass","removeClass","alert","updateConfigForm","$config","entries","key","inputId","$label","$input"],"mappings":"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"}