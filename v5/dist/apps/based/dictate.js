class t{constructor(t,e={}){this.bp=t,this.settings={dictationEnabled:e.dictationEnabled||!0,language:e.language||"en-US"},this.recognition=null}async init(){if("SpeechRecognition"in window||"webkitSpeechRecognition"in window){const t=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new t,this.recognition.continuous=!1,this.recognition.interimResults=!1,this.recognition.lang=this.settings.language,this.available=!0,this.recognition.onresult=this.onResult.bind(this),this.recognition.onerror=this.onError.bind(this),this.recognition.onend=this.onEnd.bind(this)}else this.available=!1,console.log("Speech Recognition not supported in this browser.");this.bp.dictate=this.start.bind(this),await this.bp.appendCSS("/v5/apps/based/dictate/dictate.css")}open({targetEl:t}){console.log("Opening Dictate recorder...",t),this.targetEl=t,this.start()}start(){if(this.available&&this.settings.dictationEnabled){if(this.listening)return console.log("Stopping speech recognition as it is already active."),void this.stop();this.hasError=!1,this.listening=!0,console.log("Starting speech recognition..."),this.recognition.start(),this.targetEl.addClass("dictate-active"),this.targetEl.attr("placeholder","Listening... Speak now!"),console.log("added class dictate-active to targetEl",this.targetEl)}else console.log("Warning: Speech recognition not available or disabled.")}stop(){this.available&&(console.log("Stopping speech recognition..."),this.recognition.stop())}onResult(t){const e=t.results[0][0].transcript;console.log("Recognized text:",e),this.targetEl.val()?this.targetEl.val(this.targetEl.val()+" "+e):this.targetEl.val(e)}onError(t){this.hasError=!0,console.error("Speech recognition error:",t.error),this.targetEl&&(this.targetEl.removeClass("dictate-active"),console.log("removed class dictate-active from targetEl",this.targetEl),this.targetEl.addClass("dictate-error"),$(this.targetEl).attr("placeholder","Dictation Error occurred: "+t.error),console.log("added class dictate-error to targetEl",this.targetEl),setTimeout((()=>{this.targetEl.removeClass("dictate-error"),this.targetEl.attr("placeholder","Type your message...")}),3e3))}onEnd(){this.targetEl&&(this.targetEl.removeClass("dictate-active"),console.log("removed class dictate-active from targetEl",this.targetEl)),this.listening=!1,this.hasError||this.targetEl.attr("placeholder","Type your message...")}enableDictation(t=!0){this.settings.dictationEnabled=t}setLanguage(t){this.settings.language=t,this.recognition&&(this.recognition.lang=t)}}export{t as default};
//# sourceMappingURL=dictate.js.map
