function e(e){let l=[{label:'<span id="me_title" class="me_title">Welcome - You look nice today!</span>',submenu:[{label:"<span>We are stoked to be your Buddy</span>",className:"desktop-only"},{label:"Buddy Apps",closeMenu:!0,click:()=>e.open("pad")},{label:"Edit Profile",closeMenu:!0,click:()=>e.open("profile")},{label:"<span>Login</span>",className:"loggedOut",click:()=>e.open("buddylist")},{label:'<span class="loggedIn">Logout</span>',click:()=>{e.logout&&e.logout(),e.apps.ui.windowManager.windows.forEach((e=>{"buddylist"!==e.app||"buddy"!==e.type&&"pond"!==e.type||e.close(),"pond"===e.app&&e.close()}))}}]},{label:"Window",className:"desktop-only",submenu:[{label:"Full Screen",click:()=>e.apps.ui.toggleFullScreen()},{label:"Hide All Windows",click:()=>e.apps.ui.windowManager.minimizeAllWindows()}]},{label:'<span style="display:flex;">$GBP&nbsp; <span id="menu-bar-coin-balance" class="odometer">0</span></span>',submenu:[{label:"View Coin Balance",closeMenu:!0,click:()=>e.open("portfolio")},{label:"Send Coins",closeMenu:!0,click:()=>e.open("portfolio",{context:"#portfolio-transfer"})}]},{className:"loggedIn",label:'\n              <span>Reward: <span id="menu-bar-coin-reward-coindown" class="countdown-date">0:59</span></span>\n              \x3c!-- <span class="loggedOut">Login to get Coin Rewards</span> --\x3e\n            '},{label:"",flex:1},{label:'\n<div class="dropdown-wrapper float_right select-playlist-dropdown-menu">\n  <span class="icon trigger" title="Select Music Playlist">\n    <i class="fa-duotone fa-regular fa-music"></i> Select Music Playlist\n  </span>\n  <ul class="dropdown-menu" style="display: none;">\n    <li data-value="1397230333">Buddy House 0 (33 Tracks)</li>\n    <li data-value="1397493787">Buddy House 1 (10 Tracks)</li>\n    <li data-value="1427128612">Buddy House 2 (10 Tracks)</li>\n  </ul>\n</div>\n    ',className:"desktop-only"},{label:'\n<div class="dropdown-wrapper desktop-settings-dropdown-menu">\n  <span class="icon trigger" title="Desktop Settings">\n    <i class="fa-duotone fa-regular fa-desktop"></i> Desktop Settings\n  </span>\n  <ul class="dropdown-menu" style="display: none;">\n    <li data-value="open">Open Desktop Settings</li>\n    <li data-value="matrix">Matrix Wallpaper</li>\n    <li data-value="nyancat">Nyan Cat Wallpaper</li>\n    <li data-value="ripples">Ripples Wallpaper</li>\n    <li data-value="urlWallpaper">Set Wallpaper to Url</li>\n    <li data-value="default">Default Wallpaper</li>\n  </ul>\n</div>\n    '},{label:'\n <div class="dropdown-wrapper desktop-settings-dropdown-menu">\n   <span class="icon trigger" title="Developers">\n    <i class="fa-duotone fa-regular fa-code"></i> Developers\n   </span>\n   <ul class="dropdown-menu" style="display: none;">\n     <li class="open-link" data-link="https://github.com/buddypond/buddypond">View Source Code</li>\n     <li class="open-link" data-link="https://buddypond.com/sdk">Developer SDK</li>\n   </ul>\n </div>\n   ',click:async e=>{let l=e.target,n=$(l).data("link");n||(n=$(l).attr("href")),window.discordMode?await window.discordSdk.commands.openExternalLink({url:n}):window.open(n,"_blank")}},{label:'\n    <div class="volume">\n    <span class="volumeIcon volumeToggle volumeFull">ðŸ”Š</span>\n    <span class="volumeIcon volumeToggle volumeMuted">ðŸ”‡</span>\n    <div class="volumeSliderContainer">\n      <div id="toggleVolumeSlider" class="volumeSlider"></div>\n      <div class="volume-enabled-checkbox">\n        <input type="checkbox" id="enableVolume" name="enableVolume">\n        <label for="enableVolume" title="Enable sound effects">Mute</label>\n      </div>\n\n    </div>\n    \n    </div>\n    ',click:e=>{console.log("Volume toggle clicked"),n(e)}},{label:'<span class="selectLightMode float_right"><i class="fa-duotone fa-regular fa-sun" data-mode="Light" title="Light Mode"></i><i class="fa-duotone fa-regular fa-moon" data-mode="Dark" title="Dark Mode"></i></span>'},{label:'\n    <span id="clock"></span>\n    '}];const n=l=>{const n=$(".volumeSliderContainer");if(n.is(":visible")){if($(l.target).closest(".volume-enabled-checkbox").length)return;if(!$(l.target).closest(".volumeSliderContainer").length)return void n.slideUp(111)}n.slideDown(111);let t=100*e.get("audio_volume");isNaN(t)&&(t=100),$("#toggleVolumeSlider").slider({min:0,max:100,value:t,create:function(){$(this).find(".ui-slider-handle").append('<span class="slider-value">'+t+"</span>")},slide:function(l,n){e.set("audio_volume",n.value/100),0===n.value&&($(".volumeFull").hide(),$(".volumeMuted").show(),$("#enableVolume").prop("checked",!0),e.set("audio_enabled",!1)),n.value>0&&($(".volumeFull").show(),$(".volumeMuted").hide(),$("#enableVolume").prop("checked",!1),e.set("audio_enabled",!0),console.log("ENABLED AUDIO")),$(this).find(".slider-value").show().text(n.value)},stop:(l,n)=>{n.value>0&&(e.set("audio_enabled",!0),$(".volumeFull").show(),$(".volumeMuted").hide(),$("#enableVolume").prop("checked",!1),console.log("ENABLED AUDIO")),console.log("play sound at volume",e.get("audio_volume")),console.log("audio_enabled",e.get("audio_enabled")),e.play("desktop/assets/audio/VOLUME-ON.mp3",{tryHard:1/0}),setTimeout((()=>{$(".slider-value").hide()}),444)}})};return l}class l{constructor(e,l={}){this.bp=e,this.options=l,this.menus={},this.currentMenuData=[],this.menuBarElement=null}async init(){await this.bp.appendCSS("/v5/apps/based/menubar/menubar.css"),this.bp.on("auth::logout","reset-menu",(()=>$(".me_title").html("Sign In"))),this.load()}load(l={},n=document.body){this.currentMenuData=e(this.bp),this.renderMenu(n)}setDefaultMenu(){this.currentMenuData=e(this.bp),this.renderMenu()}setMenu(e,l){e?l?this.menus[e]=l:delete this.menus[e]:this.currentMenuData=l||[];const n=this.currentMenuData.length?this.currentMenuData:Object.values(this.menus).flat();console.log("new menuData",n),this.renderMenu(void 0,l)}renderMenu(e=document.body,l=this.currentMenuData){let t;this.menuBarElement&&this.menuBarElement.remove(),this.menuBar=new n(l).createMenu(),this.menuBarElement=this.menuBar.menuBarElement,e.appendChild(this.menuBarElement),this.bp.isMobile()&&$(".desktop-only").remove(),this.bp.settings.active_theme?$(".selectTheme",this.menuBarElement).val(this.bp.settings.active_theme):$(".selectTheme",this.menuBarElement).val("Dark"),!1===this.bp.settings.audio_enabled?($(".volumeFull").hide(),$(".volumeMuted").show()):($(".volumeFull").show(),$(".volumeMuted").hide()),$(".selectLightMode i",this.menuBarElement).on("click",(function(e){let l=$(e.target).data("mode");bp.apps.themes.applyTheme(l)})),$(".selectPlaylist",this.menuBarElement).on("change",(function(){$("#soundcloudiframe").remove(),$("#soundcloudplayer").html(""),bp.apps.soundcloud&&(bp.apps.soundcloud.soundCloudEmbeded=!1),bp.open("soundcloud",{playlistID:$(this).val()})})),$(".icon.trigger").on("click",(function(e){e.stopPropagation(),$(this).siblings(".dropdown-menu").slideToggle(200)})),$(".desktop-settings-dropdown-menu li").on("click",(async e=>{const l=$(e.target).data("value");if($(e.target).text(),$(e.target).parent().slideUp(200),console.log("Selected:",l),l){if("urlWallpaper"===l)return await this.bp.open("profile",{context:"themes"}),void $("#wallPaperRadiourl").click();if("open"===l)return bp.open("profile",{context:"themes"}),console.log("Opening desktop settings",this),void this.menuBar.closeMobileMenu();"default"===l&&bp.apps.wallpaper.setDefaultWallpaper(),bp.set("wallpaper_name",l)}})),$(".select-playlist-dropdown-menu li").on("click",(function(){const e=$(this).data("value");$(this).text(),$(this).parent().slideUp(200),console.log("Selected:",e),$("#soundcloudiframe").remove(),$("#soundcloudplayer").html(""),bp.apps.soundcloud&&(bp.apps.soundcloud.soundCloudEmbeded=!1),bp.open("soundcloud",{playlistID:e})})),$("#enableVolume").on("change",(function(){$(this).is(":checked")?($(".volumeFull").hide(),$(".volumeMuted").show(),bp.set("audio_enabled",!1)):($(".volumeFull").show(),$(".volumeMuted").hide(),bp.set("audio_enabled",!0),bp.play("desktop/assets/audio/VOLUME-ON.mp3",{tryHard:1/0}))})),$(".volumeSliderContainer").on("mouseleave",(e=>{t=setTimeout((()=>{$(".volumeSliderContainer").slideUp(111)}),666)})),$(".volumeSliderContainer").on("mouseenter",(()=>{clearTimeout(t)})),$(document).on("click",(function(e){console.log("Document click",e.target),$(e.target).closest(".dropdown-wrapper").length||$(".dropdown-menu").slideUp(200),$(e.target).closest("#toggleVolumeSlider").length||$(e.target).closest(".volumeSliderContainer").length||(console.log("Hiding volume slider"),$(".volumeSliderContainer").hide())}));let a=$("#menu-bar-coin-reward-coindown");function s(){const e=new Date(Date.now()+6e4);bp.apps.ui.countdownManager.startCountdown(a,e,(function e(l){bp.apps.rewards.requestReward(),setTimeout((()=>{const n=new Date(Date.now()+6e4);bp.apps.ui.countdownManager.startCountdown(l,n,e)}),10)}))}this.bp.qtokenid?s():($(".loggedIn").flexHide(),this.bp.on("auth::qtoken","start-rewards-timer",(()=>{s()})))}}class n{constructor(e,l={}){this.menuTemplate=e,this.menuBarElement=null,this.id=l.id||"menu-bar"}createMenu(){return this.menuBarElement=document.createElement("div"),this.menuBarElement.classList.add("menu-bar"),this.menuBarElement.classList.add("desktop-menu-bar"),this.menuBarElement.id=this.id,this.menuTemplate.forEach((e=>this.createMenuItem(e))),this.menuBarElement.classList.add("responsive-ready"),this.addGlobalEventListeners(),this}createMenuItem(e){const l=document.createElement("div");if(l.classList.add("menu-item"),l.innerHTML=e.label,e.flex&&(l.style.flex=e.flex),e.className&&l.classList.add(e.className),e.click&&(l.onclick=l=>{l.stopPropagation(),e.click(l),e.closeMenu&&this.closeMobileMenu()}),e.submenu){const n=this.createSubMenu(e.submenu);l.appendChild(n);window.matchMedia("(max-width: 1000px)").matches?l.addEventListener("click",(e=>{e.stopPropagation(),n.classList.toggle("open")})):(l.addEventListener("mouseover",(()=>n.style.display="block")),l.addEventListener("mouseleave",(()=>n.style.display="none")))}this.menuBarElement.appendChild(l)}createSubMenu(e){const l=document.createElement("div");return l.classList.add("submenu"),e.forEach((e=>{const n=document.createElement("div");if(n.classList.add("submenu-item"),n.innerHTML=e.label,e.className&&n.classList.add(e.className),e.click&&(n.onclick=l=>{l.stopPropagation(),e.click(),e.closeMenu&&this.closeMobileMenu()}),e.submenu){const l=this.createSubMenu(e.submenu);n.appendChild(l),n.addEventListener("mouseover",(()=>l.style.display="block")),n.addEventListener("mouseleave",(()=>l.style.display="none"))}l.appendChild(n)})),l}addGlobalEventListeners(){document.addEventListener("click",(e=>{this.menuBarElement.contains(e.target)||this.closeAllSubmenus()})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&this.closeAllSubmenus()}))}closeAllSubmenus(){document.querySelectorAll(".submenu").forEach((e=>e.style.display="none"))}closeMobileMenu(){const e=$(this.menuBarElement);e.hasClass("mobile-active")&&e.animate({left:"-100%"},300,(()=>{e.removeClass("mobile-active")}))}}export{l as default};
//# sourceMappingURL=menubar.js.map
